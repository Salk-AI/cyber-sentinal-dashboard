"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.updateUserPreferences = void 0;
var _constants = require("../../../common/constants");
var _pluginServices = require("../../plugin-services");
var _savedObject = require("../saved-object");
const updateUserPreferences = async (username, preferences) => {
  try {
    const userPreferences = (await (0, _savedObject.getSavedObject)(_constants.SAVED_OBJECT_USER_PREFERENCES, username)) || {};
    const newUserPreferences = {
      ...userPreferences,
      ...preferences
    };
    await (0, _savedObject.setSavedObject)(_constants.SAVED_OBJECT_USER_PREFERENCES, newUserPreferences, username);
    return newUserPreferences;
  } catch (error) {
    const message = error instanceof Error ? error.message : typeof error === 'string' ? error : 'Error trying to update user preferences';
    const {
      logger
    } = (0, _pluginServices.getWazuhCheckUpdatesServices)();
    logger.error(message);
    return Promise.reject(error);
  }
};
exports.updateUserPreferences = updateUserPreferences;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY29uc3RhbnRzIiwicmVxdWlyZSIsIl9wbHVnaW5TZXJ2aWNlcyIsIl9zYXZlZE9iamVjdCIsInVwZGF0ZVVzZXJQcmVmZXJlbmNlcyIsInVzZXJuYW1lIiwicHJlZmVyZW5jZXMiLCJ1c2VyUHJlZmVyZW5jZXMiLCJnZXRTYXZlZE9iamVjdCIsIlNBVkVEX09CSkVDVF9VU0VSX1BSRUZFUkVOQ0VTIiwibmV3VXNlclByZWZlcmVuY2VzIiwic2V0U2F2ZWRPYmplY3QiLCJlcnJvciIsIm1lc3NhZ2UiLCJFcnJvciIsImxvZ2dlciIsImdldFdhenVoQ2hlY2tVcGRhdGVzU2VydmljZXMiLCJQcm9taXNlIiwicmVqZWN0IiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInVwZGF0ZS11c2VyLXByZWZlcmVuY2VzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNBVkVEX09CSkVDVF9VU0VSX1BSRUZFUkVOQ0VTIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBVc2VyUHJlZmVyZW5jZXMgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vdHlwZXMnO1xuaW1wb3J0IHsgZ2V0V2F6dWhDaGVja1VwZGF0ZXNTZXJ2aWNlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi1zZXJ2aWNlcyc7XG5pbXBvcnQgeyBnZXRTYXZlZE9iamVjdCwgc2V0U2F2ZWRPYmplY3QgfSBmcm9tICcuLi9zYXZlZC1vYmplY3QnO1xuXG5leHBvcnQgY29uc3QgdXBkYXRlVXNlclByZWZlcmVuY2VzID0gYXN5bmMgKFxuICB1c2VybmFtZTogc3RyaW5nLFxuICBwcmVmZXJlbmNlczogVXNlclByZWZlcmVuY2VzLFxuKTogUHJvbWlzZTxVc2VyUHJlZmVyZW5jZXM+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyUHJlZmVyZW5jZXMgPVxuICAgICAgKChhd2FpdCBnZXRTYXZlZE9iamVjdChcbiAgICAgICAgU0FWRURfT0JKRUNUX1VTRVJfUFJFRkVSRU5DRVMsXG4gICAgICAgIHVzZXJuYW1lLFxuICAgICAgKSkgYXMgVXNlclByZWZlcmVuY2VzKSB8fCB7fTtcblxuICAgIGNvbnN0IG5ld1VzZXJQcmVmZXJlbmNlcyA9IHsgLi4udXNlclByZWZlcmVuY2VzLCAuLi5wcmVmZXJlbmNlcyB9O1xuXG4gICAgYXdhaXQgc2V0U2F2ZWRPYmplY3QoXG4gICAgICBTQVZFRF9PQkpFQ1RfVVNFUl9QUkVGRVJFTkNFUyxcbiAgICAgIG5ld1VzZXJQcmVmZXJlbmNlcyxcbiAgICAgIHVzZXJuYW1lLFxuICAgICk7XG5cbiAgICByZXR1cm4gbmV3VXNlclByZWZlcmVuY2VzO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnN0IG1lc3NhZ2UgPVxuICAgICAgZXJyb3IgaW5zdGFuY2VvZiBFcnJvclxuICAgICAgICA/IGVycm9yLm1lc3NhZ2VcbiAgICAgICAgOiB0eXBlb2YgZXJyb3IgPT09ICdzdHJpbmcnXG4gICAgICAgID8gZXJyb3JcbiAgICAgICAgOiAnRXJyb3IgdHJ5aW5nIHRvIHVwZGF0ZSB1c2VyIHByZWZlcmVuY2VzJztcblxuICAgIGNvbnN0IHsgbG9nZ2VyIH0gPSBnZXRXYXp1aENoZWNrVXBkYXRlc1NlcnZpY2VzKCk7XG5cbiAgICBsb2dnZXIuZXJyb3IobWVzc2FnZSk7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgfVxufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsVUFBQSxHQUFBQyxPQUFBO0FBRUEsSUFBQUMsZUFBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsWUFBQSxHQUFBRixPQUFBO0FBRU8sTUFBTUcscUJBQXFCLEdBQUcsTUFBQUEsQ0FDbkNDLFFBQWdCLEVBQ2hCQyxXQUE0QixLQUNDO0VBQzdCLElBQUk7SUFDRixNQUFNQyxlQUFlLEdBQ25CLENBQUUsTUFBTSxJQUFBQywyQkFBYyxFQUNwQkMsd0NBQTZCLEVBQzdCSixRQUNGLENBQUMsS0FBeUIsQ0FBQyxDQUFDO0lBRTlCLE1BQU1LLGtCQUFrQixHQUFHO01BQUUsR0FBR0gsZUFBZTtNQUFFLEdBQUdEO0lBQVksQ0FBQztJQUVqRSxNQUFNLElBQUFLLDJCQUFjLEVBQ2xCRix3Q0FBNkIsRUFDN0JDLGtCQUFrQixFQUNsQkwsUUFDRixDQUFDO0lBRUQsT0FBT0ssa0JBQWtCO0VBQzNCLENBQUMsQ0FBQyxPQUFPRSxLQUFLLEVBQUU7SUFDZCxNQUFNQyxPQUFPLEdBQ1hELEtBQUssWUFBWUUsS0FBSyxHQUNsQkYsS0FBSyxDQUFDQyxPQUFPLEdBQ2IsT0FBT0QsS0FBSyxLQUFLLFFBQVEsR0FDekJBLEtBQUssR0FDTCx5Q0FBeUM7SUFFL0MsTUFBTTtNQUFFRztJQUFPLENBQUMsR0FBRyxJQUFBQyw0Q0FBNEIsRUFBQyxDQUFDO0lBRWpERCxNQUFNLENBQUNILEtBQUssQ0FBQ0MsT0FBTyxDQUFDO0lBQ3JCLE9BQU9JLE9BQU8sQ0FBQ0MsTUFBTSxDQUFDTixLQUFLLENBQUM7RUFDOUI7QUFDRixDQUFDO0FBQUNPLE9BQUEsQ0FBQWYscUJBQUEsR0FBQUEscUJBQUEifQ==