"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ServerAPIClient = void 0;
var _axios = _interopRequireDefault(require("axios"));
var _https = _interopRequireDefault(require("https"));
var _cookie = require("./cookie");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(arg) { var key = _toPrimitive(arg, "string"); return typeof key === "symbol" ? key : String(key); }
function _toPrimitive(input, hint) { if (typeof input !== "object" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || "default"); if (typeof res !== "object") return res; throw new TypeError("@@toPrimitive must return a primitive value."); } return (hint === "string" ? String : Number)(input); } /*
 * Wazuh app - Interceptor API entries
 * Copyright (C) 2015-2022 Wazuh, Inc.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * Find more information about this on the LICENSE file.
 */
/**
 * This service communicates with the Wazuh server APIs
 */
class ServerAPIClient {
  constructor(logger,
  // TODO: add logger as needed
  manageHosts, dashboardSecurity) {
    this.logger = logger;
    this.manageHosts = manageHosts;
    this.dashboardSecurity = dashboardSecurity;
    _defineProperty(this, "_CacheInternalUserAPIHostToken", void 0);
    _defineProperty(this, "_axios", void 0);
    _defineProperty(this, "asInternalUser", void 0);
    _defineProperty(this, "_axios", void 0);
    const httpsAgent = new _https.default.Agent({
      rejectUnauthorized: false
    });
    this._axios = _axios.default.create({
      httpsAgent
    });
    // Cache to save the token for the internal user by API host ID
    this._CacheInternalUserAPIHostToken = new Map();

    // Create internal user client
    this.asInternalUser = {
      authenticate: async apiHostID => await this._authenticateInternalUser(apiHostID),
      request: async (method, path, data, options) => await this._requestAsInternalUser(method, path, data, options)
    };
  }

  /**
   * Internal method to execute the request
   * @param method HTTP verb
   * @param path Server API endpoint
   * @param data Request data
   * @param options Options. Data about the Server API ID and the token
   * @returns
   */
  async _request(method, path, data, options) {
    const optionsRequest = await this._buildRequestOptions(method, path, data, options);
    return await this._axios(optionsRequest);
  }

  /**
   * Build the options for the request
   * @param method HTTP verb
   * @param path Server API endpoint
   * @param data Request data
   * @param options Options. Data about the Server API ID and the token
   * @returns
   */
  async _buildRequestOptions(method, path, data, {
    apiHostID,
    token
  }) {
    const api = await this.manageHosts.get(apiHostID);
    const {
      body,
      params,
      headers,
      ...rest
    } = data;
    return {
      method: method,
      headers: {
        'content-type': 'application/json',
        Authorization: 'Bearer ' + token,
        ...(headers ? headers : {})
      },
      data: body || rest || {},
      params: params || {},
      url: `${api.url}:${api.port}${path}`
    };
  }

  /**
   * Get the authentication token
   * @param apiHostID Server API ID
   * @param authContext Authentication context to get the token
   * @returns
   */
  async _authenticate(apiHostID, options) {
    const api = await this.manageHosts.get(apiHostID);
    const optionsRequest = {
      method: 'POST',
      headers: {
        'content-type': 'application/json'
      },
      auth: {
        username: api.username,
        password: api.password
      },
      url: `${api.url}:${api.port}/security/user/authenticate${options.useRunAs ? '/run_as' : ''}`,
      ...(!!(options !== null && options !== void 0 && options.authContext) ? {
        data: options === null || options === void 0 ? void 0 : options.authContext
      } : {})
    };
    const response = await this._axios(optionsRequest);
    const token = (((response || {}).data || {}).data || {}).token;
    return token;
  }

  /**
   * Get the authentication token for the internal user and cache it
   * @param apiHostID Server API ID
   * @returns
   */
  async _authenticateInternalUser(apiHostID) {
    const token = await this._authenticate(apiHostID, {
      useRunAs: false
    });
    this._CacheInternalUserAPIHostToken.set(apiHostID, token);
    return token;
  }

  /**
   * Create a client from the context and request
   * @param context
   * @param request
   * @returns
   */
  asScoped(context, request) {
    return {
      authenticate: async apiHostID => {
        const useRunAs = this.manageHosts.isEnabledAuthWithRunAs(apiHostID);
        const token = useRunAs ? await this._authenticate(apiHostID, {
          useRunAs: true,
          authContext: (await this.dashboardSecurity.getCurrentUser(request, context)).authContext
        }) : await this._authenticate(apiHostID, {
          useRunAs: false
        });
        return token;
      },
      request: async (method, path, data, options) => {
        return await this._request(method, path, data, {
          ...options,
          token: (0, _cookie.getCookieValueByName)(request.headers.cookie, 'wz-token')
        });
      }
    };
  }

  /**
   * Request as internal user
   * @param method HTTP verb
   * @param path Server API endpoint
   * @param data Request data
   * @param options Options. Data about the Server API ID and the token
   * @returns
   */
  async _requestAsInternalUser(method, path, data, options) {
    try {
      const token = this._CacheInternalUserAPIHostToken.has(options.apiHostID) && !options.forceRefresh ? this._CacheInternalUserAPIHostToken.get(options.apiHostID) : await this._authenticateInternalUser(options.apiHostID);
      return await this._request(method, path, data, {
        ...options,
        token
      });
    } catch (error) {
      if (error.response && error.response.status === 401) {
        const token = await this._authenticateInternalUser(options.apiHostID);
        return await this._request(method, path, data, {
          ...options,
          token
        });
      }
      throw error;
    }
  }
}
exports.ServerAPIClient = ServerAPIClient;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYXhpb3MiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9odHRwcyIsIl9jb29raWUiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9kZWZpbmVQcm9wZXJ0eSIsImtleSIsInZhbHVlIiwiX3RvUHJvcGVydHlLZXkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImFyZyIsIl90b1ByaW1pdGl2ZSIsIlN0cmluZyIsImlucHV0IiwiaGludCIsInByaW0iLCJTeW1ib2wiLCJ0b1ByaW1pdGl2ZSIsInVuZGVmaW5lZCIsInJlcyIsImNhbGwiLCJUeXBlRXJyb3IiLCJOdW1iZXIiLCJTZXJ2ZXJBUElDbGllbnQiLCJjb25zdHJ1Y3RvciIsImxvZ2dlciIsIm1hbmFnZUhvc3RzIiwiZGFzaGJvYXJkU2VjdXJpdHkiLCJodHRwc0FnZW50IiwiaHR0cHMiLCJBZ2VudCIsInJlamVjdFVuYXV0aG9yaXplZCIsImF4aW9zIiwiY3JlYXRlIiwiX0NhY2hlSW50ZXJuYWxVc2VyQVBJSG9zdFRva2VuIiwiTWFwIiwiYXNJbnRlcm5hbFVzZXIiLCJhdXRoZW50aWNhdGUiLCJhcGlIb3N0SUQiLCJfYXV0aGVudGljYXRlSW50ZXJuYWxVc2VyIiwicmVxdWVzdCIsIm1ldGhvZCIsInBhdGgiLCJkYXRhIiwib3B0aW9ucyIsIl9yZXF1ZXN0QXNJbnRlcm5hbFVzZXIiLCJfcmVxdWVzdCIsIm9wdGlvbnNSZXF1ZXN0IiwiX2J1aWxkUmVxdWVzdE9wdGlvbnMiLCJ0b2tlbiIsImFwaSIsImdldCIsImJvZHkiLCJwYXJhbXMiLCJoZWFkZXJzIiwicmVzdCIsIkF1dGhvcml6YXRpb24iLCJ1cmwiLCJwb3J0IiwiX2F1dGhlbnRpY2F0ZSIsImF1dGgiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwidXNlUnVuQXMiLCJhdXRoQ29udGV4dCIsInJlc3BvbnNlIiwic2V0IiwiYXNTY29wZWQiLCJjb250ZXh0IiwiaXNFbmFibGVkQXV0aFdpdGhSdW5BcyIsImdldEN1cnJlbnRVc2VyIiwiZ2V0Q29va2llVmFsdWVCeU5hbWUiLCJjb29raWUiLCJoYXMiLCJmb3JjZVJlZnJlc2giLCJlcnJvciIsInN0YXR1cyIsImV4cG9ydHMiXSwic291cmNlcyI6WyJzZXJ2ZXItYXBpLWNsaWVudC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogV2F6dWggYXBwIC0gSW50ZXJjZXB0b3IgQVBJIGVudHJpZXNcbiAqIENvcHlyaWdodCAoQykgMjAxNS0yMDIyIFdhenVoLCBJbmMuXG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnlcbiAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5XG4gKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvclxuICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBGaW5kIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhpcyBvbiB0aGUgTElDRU5TRSBmaWxlLlxuICovXG5cbmltcG9ydCBheGlvcywgeyBBeGlvc0luc3RhbmNlLCBBeGlvc1Jlc3BvbnNlIH0gZnJvbSAnYXhpb3MnO1xuaW1wb3J0IGh0dHBzIGZyb20gJ2h0dHBzJztcbmltcG9ydCB7IExvZ2dlciB9IGZyb20gJ29wZW5zZWFyY2gtZGFzaGJvYXJkcy9zZXJ2ZXInO1xuaW1wb3J0IHsgZ2V0Q29va2llVmFsdWVCeU5hbWUgfSBmcm9tICcuL2Nvb2tpZSc7XG5pbXBvcnQgeyBNYW5hZ2VIb3N0cyB9IGZyb20gJy4vbWFuYWdlLWhvc3RzJztcbmltcG9ydCB7IElTZWN1cml0eUZhY3RvcnkgfSBmcm9tICcuL3NlY3VyaXR5LWZhY3RvcnknO1xuXG5pbnRlcmZhY2UgQVBJSG9zdCB7XG4gIGlkOiBzdHJpbmc7XG4gIHVybDogc3RyaW5nO1xuICB1c2VybmFtZTogc3RyaW5nO1xuICBwYXNzd29yZDogc3RyaW5nO1xuICBwb3J0OiBudW1iZXI7XG4gIHJ1bl9hczogYm9vbGVhbjtcbn1cblxudHlwZSBSZXF1ZXN0SFRUUE1ldGhvZCA9ICdERUxFVEUnIHwgJ0dFVCcgfCAnUEFUQ0gnIHwgJ1BPU1QnIHwgJ1BVVCc7XG50eXBlIFJlcXVlc3RQYXRoID0gc3RyaW5nO1xuXG5leHBvcnQgaW50ZXJmYWNlIEFQSUludGVyY2VwdG9yUmVxdWVzdE9wdGlvbnMge1xuICBhcGlIb3N0SUQ6IHN0cmluZztcbiAgdG9rZW46IHN0cmluZztcbiAgZm9yY2VSZWZyZXNoPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBUElJbnRlcmNlcHRvclJlcXVlc3RPcHRpb25zSW50ZXJuYWxVc2VyIHtcbiAgYXBpSG9zdElEOiBzdHJpbmc7XG4gIGZvcmNlUmVmcmVzaD86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQVBJSW50ZXJjZXB0b3JSZXF1ZXN0T3B0aW9uc1Njb3BlZFVzZXIge1xuICBhcGlIb3N0SUQ6IHN0cmluZztcbiAgZm9yY2VSZWZyZXNoPzogYm9vbGVhbjtcbiAgdG9rZW46IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZXJ2ZXJBUElJbnRlcm5hbFVzZXJDbGllbnQge1xuICBhdXRoZW50aWNhdGU6IChhcGlIb3N0SUQ6IHN0cmluZykgPT4gUHJvbWlzZTxhbnk+O1xuICByZXF1ZXN0OiAoXG4gICAgbWV0aG9kOiBSZXF1ZXN0SFRUUE1ldGhvZCxcbiAgICBwYXRoOiBSZXF1ZXN0UGF0aCxcbiAgICBkYXRhOiBhbnksXG4gICAgb3B0aW9uczogQVBJSW50ZXJjZXB0b3JSZXF1ZXN0T3B0aW9uc0ludGVybmFsVXNlcixcbiAgKSA9PiBQcm9taXNlPEF4aW9zUmVzcG9uc2U8YW55LCBhbnk+Pjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZXJ2ZXJBUElTY29wZWRVc2VyQ2xpZW50IHtcbiAgYXV0aGVudGljYXRlOiAoYXBpSG9zdElEOiBzdHJpbmcpID0+IFByb21pc2U8YW55PjtcbiAgcmVxdWVzdDogKFxuICAgIG1ldGhvZDogUmVxdWVzdEhUVFBNZXRob2QsXG4gICAgcGF0aDogUmVxdWVzdFBhdGgsXG4gICAgZGF0YTogYW55LFxuICAgIG9wdGlvbnM6IEFQSUludGVyY2VwdG9yUmVxdWVzdE9wdGlvbnNTY29wZWRVc2VyLFxuICApID0+IFByb21pc2U8QXhpb3NSZXNwb25zZTxhbnksIGFueT4+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlcnZlckFQSUF1dGhlbnRpY2F0ZU9wdGlvbnMge1xuICB1c2VSdW5BczogYm9vbGVhbjtcbiAgYXV0aENvbnRleHQ/OiBhbnk7XG59XG5cbi8qKlxuICogVGhpcyBzZXJ2aWNlIGNvbW11bmljYXRlcyB3aXRoIHRoZSBXYXp1aCBzZXJ2ZXIgQVBJc1xuICovXG5leHBvcnQgY2xhc3MgU2VydmVyQVBJQ2xpZW50IHtcbiAgcHJpdmF0ZSBfQ2FjaGVJbnRlcm5hbFVzZXJBUElIb3N0VG9rZW46IE1hcDxzdHJpbmcsIHN0cmluZz47XG4gIHByaXZhdGUgX2F4aW9zOiB0eXBlb2YgYXhpb3M7XG4gIHByaXZhdGUgYXNJbnRlcm5hbFVzZXI6IFNlcnZlckFQSUludGVybmFsVXNlckNsaWVudDtcbiAgcHJpdmF0ZSBfYXhpb3M6IEF4aW9zSW5zdGFuY2U7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgbG9nZ2VyOiBMb2dnZXIsIC8vIFRPRE86IGFkZCBsb2dnZXIgYXMgbmVlZGVkXG4gICAgcHJpdmF0ZSBtYW5hZ2VIb3N0czogTWFuYWdlSG9zdHMsXG4gICAgcHJpdmF0ZSBkYXNoYm9hcmRTZWN1cml0eTogSVNlY3VyaXR5RmFjdG9yeSxcbiAgKSB7XG4gICAgY29uc3QgaHR0cHNBZ2VudCA9IG5ldyBodHRwcy5BZ2VudCh7XG4gICAgICByZWplY3RVbmF1dGhvcml6ZWQ6IGZhbHNlLFxuICAgIH0pO1xuICAgIHRoaXMuX2F4aW9zID0gYXhpb3MuY3JlYXRlKHsgaHR0cHNBZ2VudCB9KTtcbiAgICAvLyBDYWNoZSB0byBzYXZlIHRoZSB0b2tlbiBmb3IgdGhlIGludGVybmFsIHVzZXIgYnkgQVBJIGhvc3QgSURcbiAgICB0aGlzLl9DYWNoZUludGVybmFsVXNlckFQSUhvc3RUb2tlbiA9IG5ldyBNYXA8c3RyaW5nLCBzdHJpbmc+KCk7XG5cbiAgICAvLyBDcmVhdGUgaW50ZXJuYWwgdXNlciBjbGllbnRcbiAgICB0aGlzLmFzSW50ZXJuYWxVc2VyID0ge1xuICAgICAgYXV0aGVudGljYXRlOiBhc3luYyBhcGlIb3N0SUQgPT5cbiAgICAgICAgYXdhaXQgdGhpcy5fYXV0aGVudGljYXRlSW50ZXJuYWxVc2VyKGFwaUhvc3RJRCksXG4gICAgICByZXF1ZXN0OiBhc3luYyAoXG4gICAgICAgIG1ldGhvZDogUmVxdWVzdEhUVFBNZXRob2QsXG4gICAgICAgIHBhdGg6IFJlcXVlc3RQYXRoLFxuICAgICAgICBkYXRhOiBhbnksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICApID0+IGF3YWl0IHRoaXMuX3JlcXVlc3RBc0ludGVybmFsVXNlcihtZXRob2QsIHBhdGgsIGRhdGEsIG9wdGlvbnMpLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogSW50ZXJuYWwgbWV0aG9kIHRvIGV4ZWN1dGUgdGhlIHJlcXVlc3RcbiAgICogQHBhcmFtIG1ldGhvZCBIVFRQIHZlcmJcbiAgICogQHBhcmFtIHBhdGggU2VydmVyIEFQSSBlbmRwb2ludFxuICAgKiBAcGFyYW0gZGF0YSBSZXF1ZXN0IGRhdGFcbiAgICogQHBhcmFtIG9wdGlvbnMgT3B0aW9ucy4gRGF0YSBhYm91dCB0aGUgU2VydmVyIEFQSSBJRCBhbmQgdGhlIHRva2VuXG4gICAqIEByZXR1cm5zXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIF9yZXF1ZXN0KFxuICAgIG1ldGhvZDogUmVxdWVzdEhUVFBNZXRob2QsXG4gICAgcGF0aDogUmVxdWVzdFBhdGgsXG4gICAgZGF0YTogYW55LFxuICAgIG9wdGlvbnM6XG4gICAgICB8IEFQSUludGVyY2VwdG9yUmVxdWVzdE9wdGlvbnNJbnRlcm5hbFVzZXJcbiAgICAgIHwgQVBJSW50ZXJjZXB0b3JSZXF1ZXN0T3B0aW9uc1Njb3BlZFVzZXIsXG4gICk6IFByb21pc2U8QXhpb3NSZXNwb25zZT4ge1xuICAgIGNvbnN0IG9wdGlvbnNSZXF1ZXN0ID0gYXdhaXQgdGhpcy5fYnVpbGRSZXF1ZXN0T3B0aW9ucyhcbiAgICAgIG1ldGhvZCxcbiAgICAgIHBhdGgsXG4gICAgICBkYXRhLFxuICAgICAgb3B0aW9ucyxcbiAgICApO1xuICAgIHJldHVybiBhd2FpdCB0aGlzLl9heGlvcyhvcHRpb25zUmVxdWVzdCk7XG4gIH1cblxuICAvKipcbiAgICogQnVpbGQgdGhlIG9wdGlvbnMgZm9yIHRoZSByZXF1ZXN0XG4gICAqIEBwYXJhbSBtZXRob2QgSFRUUCB2ZXJiXG4gICAqIEBwYXJhbSBwYXRoIFNlcnZlciBBUEkgZW5kcG9pbnRcbiAgICogQHBhcmFtIGRhdGEgUmVxdWVzdCBkYXRhXG4gICAqIEBwYXJhbSBvcHRpb25zIE9wdGlvbnMuIERhdGEgYWJvdXQgdGhlIFNlcnZlciBBUEkgSUQgYW5kIHRoZSB0b2tlblxuICAgKiBAcmV0dXJuc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBfYnVpbGRSZXF1ZXN0T3B0aW9ucyhcbiAgICBtZXRob2Q6IFJlcXVlc3RIVFRQTWV0aG9kLFxuICAgIHBhdGg6IFJlcXVlc3RQYXRoLFxuICAgIGRhdGE6IGFueSxcbiAgICB7IGFwaUhvc3RJRCwgdG9rZW4gfTogQVBJSW50ZXJjZXB0b3JSZXF1ZXN0T3B0aW9ucyxcbiAgKSB7XG4gICAgY29uc3QgYXBpID0gYXdhaXQgdGhpcy5tYW5hZ2VIb3N0cy5nZXQoYXBpSG9zdElEKTtcbiAgICBjb25zdCB7IGJvZHksIHBhcmFtcywgaGVhZGVycywgLi4ucmVzdCB9ID0gZGF0YTtcbiAgICByZXR1cm4ge1xuICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIEF1dGhvcml6YXRpb246ICdCZWFyZXIgJyArIHRva2VuLFxuICAgICAgICAuLi4oaGVhZGVycyA/IGhlYWRlcnMgOiB7fSksXG4gICAgICB9LFxuICAgICAgZGF0YTogYm9keSB8fCByZXN0IHx8IHt9LFxuICAgICAgcGFyYW1zOiBwYXJhbXMgfHwge30sXG4gICAgICB1cmw6IGAke2FwaS51cmx9OiR7YXBpLnBvcnR9JHtwYXRofWAsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGF1dGhlbnRpY2F0aW9uIHRva2VuXG4gICAqIEBwYXJhbSBhcGlIb3N0SUQgU2VydmVyIEFQSSBJRFxuICAgKiBAcGFyYW0gYXV0aENvbnRleHQgQXV0aGVudGljYXRpb24gY29udGV4dCB0byBnZXQgdGhlIHRva2VuXG4gICAqIEByZXR1cm5zXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIF9hdXRoZW50aWNhdGUoXG4gICAgYXBpSG9zdElEOiBzdHJpbmcsXG4gICAgb3B0aW9uczogU2VydmVyQVBJQXV0aGVudGljYXRlT3B0aW9ucyxcbiAgKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBhcGkgPSAoYXdhaXQgdGhpcy5tYW5hZ2VIb3N0cy5nZXQoYXBpSG9zdElEKSkgYXMgQVBJSG9zdDtcbiAgICBjb25zdCBvcHRpb25zUmVxdWVzdCA9IHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgfSxcbiAgICAgIGF1dGg6IHtcbiAgICAgICAgdXNlcm5hbWU6IGFwaS51c2VybmFtZSxcbiAgICAgICAgcGFzc3dvcmQ6IGFwaS5wYXNzd29yZCxcbiAgICAgIH0sXG4gICAgICB1cmw6IGAke2FwaS51cmx9OiR7YXBpLnBvcnR9L3NlY3VyaXR5L3VzZXIvYXV0aGVudGljYXRlJHtcbiAgICAgICAgb3B0aW9ucy51c2VSdW5BcyA/ICcvcnVuX2FzJyA6ICcnXG4gICAgICB9YCxcbiAgICAgIC4uLighIW9wdGlvbnM/LmF1dGhDb250ZXh0ID8geyBkYXRhOiBvcHRpb25zPy5hdXRoQ29udGV4dCB9IDoge30pLFxuICAgIH07XG5cbiAgICBjb25zdCByZXNwb25zZTogQXhpb3NSZXNwb25zZSA9IGF3YWl0IHRoaXMuX2F4aW9zKG9wdGlvbnNSZXF1ZXN0KTtcbiAgICBjb25zdCB0b2tlbjogc3RyaW5nID0gKCgocmVzcG9uc2UgfHwge30pLmRhdGEgfHwge30pLmRhdGEgfHwge30pLnRva2VuO1xuICAgIHJldHVybiB0b2tlbjtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGF1dGhlbnRpY2F0aW9uIHRva2VuIGZvciB0aGUgaW50ZXJuYWwgdXNlciBhbmQgY2FjaGUgaXRcbiAgICogQHBhcmFtIGFwaUhvc3RJRCBTZXJ2ZXIgQVBJIElEXG4gICAqIEByZXR1cm5zXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIF9hdXRoZW50aWNhdGVJbnRlcm5hbFVzZXIoYXBpSG9zdElEOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IHRva2VuID0gYXdhaXQgdGhpcy5fYXV0aGVudGljYXRlKGFwaUhvc3RJRCwgeyB1c2VSdW5BczogZmFsc2UgfSk7XG4gICAgdGhpcy5fQ2FjaGVJbnRlcm5hbFVzZXJBUElIb3N0VG9rZW4uc2V0KGFwaUhvc3RJRCwgdG9rZW4pO1xuICAgIHJldHVybiB0b2tlbjtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBjbGllbnQgZnJvbSB0aGUgY29udGV4dCBhbmQgcmVxdWVzdFxuICAgKiBAcGFyYW0gY29udGV4dFxuICAgKiBAcGFyYW0gcmVxdWVzdFxuICAgKiBAcmV0dXJuc1xuICAgKi9cbiAgYXNTY29wZWQoY29udGV4dDogYW55LCByZXF1ZXN0OiBhbnkpOiBTZXJ2ZXJBUElTY29wZWRVc2VyQ2xpZW50IHtcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aGVudGljYXRlOiBhc3luYyAoYXBpSG9zdElEOiBzdHJpbmcpID0+IHtcbiAgICAgICAgY29uc3QgdXNlUnVuQXMgPSB0aGlzLm1hbmFnZUhvc3RzLmlzRW5hYmxlZEF1dGhXaXRoUnVuQXMoYXBpSG9zdElEKTtcblxuICAgICAgICBjb25zdCB0b2tlbiA9IHVzZVJ1bkFzXG4gICAgICAgICAgPyBhd2FpdCB0aGlzLl9hdXRoZW50aWNhdGUoYXBpSG9zdElELCB7XG4gICAgICAgICAgICAgIHVzZVJ1bkFzOiB0cnVlLFxuICAgICAgICAgICAgICBhdXRoQ29udGV4dDogKFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZGFzaGJvYXJkU2VjdXJpdHkuZ2V0Q3VycmVudFVzZXIocmVxdWVzdCwgY29udGV4dClcbiAgICAgICAgICAgICAgKS5hdXRoQ29udGV4dCxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgOiBhd2FpdCB0aGlzLl9hdXRoZW50aWNhdGUoYXBpSG9zdElELCB7XG4gICAgICAgICAgICAgIHVzZVJ1bkFzOiBmYWxzZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdG9rZW47XG4gICAgICB9LFxuICAgICAgcmVxdWVzdDogYXN5bmMgKFxuICAgICAgICBtZXRob2Q6IFJlcXVlc3RIVFRQTWV0aG9kLFxuICAgICAgICBwYXRoOiBzdHJpbmcsXG4gICAgICAgIGRhdGE6IGFueSxcbiAgICAgICAgb3B0aW9uczogQVBJSW50ZXJjZXB0b3JSZXF1ZXN0T3B0aW9uc1Njb3BlZFVzZXIsXG4gICAgICApID0+IHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuX3JlcXVlc3QobWV0aG9kLCBwYXRoLCBkYXRhLCB7XG4gICAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgICB0b2tlbjogZ2V0Q29va2llVmFsdWVCeU5hbWUocmVxdWVzdC5oZWFkZXJzLmNvb2tpZSwgJ3d6LXRva2VuJyksXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFJlcXVlc3QgYXMgaW50ZXJuYWwgdXNlclxuICAgKiBAcGFyYW0gbWV0aG9kIEhUVFAgdmVyYlxuICAgKiBAcGFyYW0gcGF0aCBTZXJ2ZXIgQVBJIGVuZHBvaW50XG4gICAqIEBwYXJhbSBkYXRhIFJlcXVlc3QgZGF0YVxuICAgKiBAcGFyYW0gb3B0aW9ucyBPcHRpb25zLiBEYXRhIGFib3V0IHRoZSBTZXJ2ZXIgQVBJIElEIGFuZCB0aGUgdG9rZW5cbiAgICogQHJldHVybnNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgX3JlcXVlc3RBc0ludGVybmFsVXNlcihcbiAgICBtZXRob2Q6IFJlcXVlc3RIVFRQTWV0aG9kLFxuICAgIHBhdGg6IFJlcXVlc3RQYXRoLFxuICAgIGRhdGE6IGFueSxcbiAgICBvcHRpb25zOiBBUElJbnRlcmNlcHRvclJlcXVlc3RPcHRpb25zSW50ZXJuYWxVc2VyLFxuICApIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdG9rZW4gPVxuICAgICAgICB0aGlzLl9DYWNoZUludGVybmFsVXNlckFQSUhvc3RUb2tlbi5oYXMob3B0aW9ucy5hcGlIb3N0SUQpICYmXG4gICAgICAgICFvcHRpb25zLmZvcmNlUmVmcmVzaFxuICAgICAgICAgID8gdGhpcy5fQ2FjaGVJbnRlcm5hbFVzZXJBUElIb3N0VG9rZW4uZ2V0KG9wdGlvbnMuYXBpSG9zdElEKVxuICAgICAgICAgIDogYXdhaXQgdGhpcy5fYXV0aGVudGljYXRlSW50ZXJuYWxVc2VyKG9wdGlvbnMuYXBpSG9zdElEKTtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLl9yZXF1ZXN0KG1ldGhvZCwgcGF0aCwgZGF0YSwgeyAuLi5vcHRpb25zLCB0b2tlbiB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yLnJlc3BvbnNlICYmIGVycm9yLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgIGNvbnN0IHRva2VuOiBzdHJpbmcgPSBhd2FpdCB0aGlzLl9hdXRoZW50aWNhdGVJbnRlcm5hbFVzZXIoXG4gICAgICAgICAgb3B0aW9ucy5hcGlIb3N0SUQsXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLl9yZXF1ZXN0KG1ldGhvZCwgcGF0aCwgZGF0YSwgeyAuLi5vcHRpb25zLCB0b2tlbiB9KTtcbiAgICAgIH1cbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFZQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxNQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFFQSxJQUFBRSxPQUFBLEdBQUFGLE9BQUE7QUFBZ0QsU0FBQUQsdUJBQUFJLEdBQUEsV0FBQUEsR0FBQSxJQUFBQSxHQUFBLENBQUFDLFVBQUEsR0FBQUQsR0FBQSxLQUFBRSxPQUFBLEVBQUFGLEdBQUE7QUFBQSxTQUFBRyxnQkFBQUgsR0FBQSxFQUFBSSxHQUFBLEVBQUFDLEtBQUEsSUFBQUQsR0FBQSxHQUFBRSxjQUFBLENBQUFGLEdBQUEsT0FBQUEsR0FBQSxJQUFBSixHQUFBLElBQUFPLE1BQUEsQ0FBQUMsY0FBQSxDQUFBUixHQUFBLEVBQUFJLEdBQUEsSUFBQUMsS0FBQSxFQUFBQSxLQUFBLEVBQUFJLFVBQUEsUUFBQUMsWUFBQSxRQUFBQyxRQUFBLG9CQUFBWCxHQUFBLENBQUFJLEdBQUEsSUFBQUMsS0FBQSxXQUFBTCxHQUFBO0FBQUEsU0FBQU0sZUFBQU0sR0FBQSxRQUFBUixHQUFBLEdBQUFTLFlBQUEsQ0FBQUQsR0FBQSwyQkFBQVIsR0FBQSxnQkFBQUEsR0FBQSxHQUFBVSxNQUFBLENBQUFWLEdBQUE7QUFBQSxTQUFBUyxhQUFBRSxLQUFBLEVBQUFDLElBQUEsZUFBQUQsS0FBQSxpQkFBQUEsS0FBQSxrQkFBQUEsS0FBQSxNQUFBRSxJQUFBLEdBQUFGLEtBQUEsQ0FBQUcsTUFBQSxDQUFBQyxX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