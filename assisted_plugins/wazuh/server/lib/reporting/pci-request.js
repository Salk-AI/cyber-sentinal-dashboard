"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.topPCIRequirements = exports.getRulesByRequirement = void 0;
var _baseQuery = require("./base-query");
/*
 * Wazuh app - Specific methods to fetch Wazuh PCI DSS data from Elasticsearch
 * Copyright (C) 2015-2022 Wazuh, Inc.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * Find more information about this on the LICENSE file.
 */

/**
 * Returns top 5 PCI DSS requirements
 * @param {*} context Endpoint context
 * @param {Number} gte Timestamp (ms) from
 * @param {Number} lte Timestamp (ms) to
 * @param {String} filters E.g: cluster.name: wazuh AND rule.groups: vulnerability
 * @returns {Array<String>}
 */
const topPCIRequirements = async (context, gte, lte, filters, allowedAgentsFilter, pattern) => {
  try {
    const base = {};
    Object.assign(base, (0, _baseQuery.Base)(pattern, filters, gte, lte, allowedAgentsFilter));
    Object.assign(base.aggs, {
      '2': {
        terms: {
          field: 'rule.pci_dss',
          size: 5,
          order: {
            _count: 'desc'
          }
        }
      }
    });
    const response = await context.core.opensearch.client.asCurrentUser.search({
      index: pattern,
      body: base
    });
    const {
      buckets
    } = response.body.aggregations['2'];
    return buckets.map(item => item.key).sort((a, b) => {
      const a_split = a.split('.');
      const b_split = b.split('.');
      if (parseInt(a_split[0]) > parseInt(b_split[0])) return 1;else if (parseInt(a_split[0]) < parseInt(b_split[0])) return -1;else {
        if (parseInt(a_split[1]) > parseInt(b_split[1])) return 1;else if (parseInt(a_split[1]) < parseInt(b_split[1])) return -1;else {
          if (parseInt(a_split[2]) > parseInt(b_split[2])) return 1;else if (parseInt(a_split[2]) < parseInt(b_split[2])) return -1;
        }
      }
    });
  } catch (error) {
    return Promise.reject(error);
  }
};

/**
 * Returns top 3 rules for specific PCI DSS requirement
 * @param {*} context Endpoint context
 * @param {Number} gte Timestamp (ms) from
 * @param {Number} lte Timestamp (ms) to
 * @param {String} requirement PCI DSS requirement. E.g: '10.2.3'
 * @param {String} filters E.g: cluster.name: wazuh AND rule.groups: vulnerability
 * @returns {Array<String>}
 */
exports.topPCIRequirements = topPCIRequirements;
const getRulesByRequirement = async (context, gte, lte, filters, allowedAgentsFilter, requirement, pattern) => {
  try {
    const base = {};
    Object.assign(base, (0, _baseQuery.Base)(pattern, filters, gte, lte, allowedAgentsFilter));
    Object.assign(base.aggs, {
      '2': {
        terms: {
          field: 'rule.description',
          size: 3,
          order: {
            _count: 'desc'
          }
        },
        aggs: {
          '3': {
            terms: {
              field: 'rule.id',
              size: 1,
              order: {
                _count: 'desc'
              }
            }
          }
        }
      }
    });
    base.query.bool.filter.push({
      match_phrase: {
        'rule.pci_dss': {
          query: requirement
        }
      }
    });
    const response = await context.core.opensearch.client.asCurrentUser.search({
      index: pattern,
      body: base
    });
    const {
      buckets
    } = response.body.aggregations['2'];
    return buckets.reduce((accum, bucket) => {
      if (!bucket || !bucket['3'] || !bucket['3'].buckets || !bucket['3'].buckets[0] || !bucket['3'].buckets[0].key || !bucket.key) {
        return accum;
      }
      accum.push({
        ruleID: bucket['3'].buckets[0].key,
        ruleDescription: bucket.key
      });
      return accum;
    }, []);
  } catch (error) {
    return Promise.reject(error);
  }
};
exports.getRulesByRequirement = getRulesByRequirement;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmFzZVF1ZXJ5IiwicmVxdWlyZSIsInRvcFBDSVJlcXVpcmVtZW50cyIsImNvbnRleHQiLCJndGUiLCJsdGUiLCJmaWx0ZXJzIiwiYWxsb3dlZEFnZW50c0ZpbHRlciIsInBhdHRlcm4iLCJiYXNlIiwiT2JqZWN0IiwiYXNzaWduIiwiQmFzZSIsImFnZ3MiLCJ0ZXJtcyIsImZpZWxkIiwic2l6ZSIsIm9yZGVyIiwiX2NvdW50IiwicmVzcG9uc2UiLCJjb3JlIiwib3BlbnNlYXJjaCIsImNsaWVudCIsImFzQ3VycmVudFVzZXIiLCJzZWFyY2giLCJpbmRleCIsImJvZHkiLCJidWNrZXRzIiwiYWdncmVnYXRpb25zIiwibWFwIiwiaXRlbSIsImtleSIsInNvcnQiLCJhIiwiYiIsImFfc3BsaXQiLCJzcGxpdCIsImJfc3BsaXQiLCJwYXJzZUludCIsImVycm9yIiwiUHJvbWlzZSIsInJlamVjdCIsImV4cG9ydHMiLCJnZXRSdWxlc0J5UmVxdWlyZW1lbnQiLCJyZXF1aXJlbWVudCIsInF1ZXJ5IiwiYm9vbCIsImZpbHRlciIsInB1c2giLCJtYXRjaF9waHJhc2UiLCJyZWR1Y2UiLCJhY2N1bSIsImJ1Y2tldCIsInJ1bGVJRCIsInJ1bGVEZXNjcmlwdGlvbiJdLCJzb3VyY2VzIjpbInBjaS1yZXF1ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBXYXp1aCBhcHAgLSBTcGVjaWZpYyBtZXRob2RzIHRvIGZldGNoIFdhenVoIFBDSSBEU1MgZGF0YSBmcm9tIEVsYXN0aWNzZWFyY2hcbiAqIENvcHlyaWdodCAoQykgMjAxNS0yMDIyIFdhenVoLCBJbmMuXG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnlcbiAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5XG4gKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvclxuICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBGaW5kIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhpcyBvbiB0aGUgTElDRU5TRSBmaWxlLlxuICovXG5pbXBvcnQgeyBCYXNlIH0gZnJvbSAnLi9iYXNlLXF1ZXJ5JztcblxuLyoqXG4gKiBSZXR1cm5zIHRvcCA1IFBDSSBEU1MgcmVxdWlyZW1lbnRzXG4gKiBAcGFyYW0geyp9IGNvbnRleHQgRW5kcG9pbnQgY29udGV4dFxuICogQHBhcmFtIHtOdW1iZXJ9IGd0ZSBUaW1lc3RhbXAgKG1zKSBmcm9tXG4gKiBAcGFyYW0ge051bWJlcn0gbHRlIFRpbWVzdGFtcCAobXMpIHRvXG4gKiBAcGFyYW0ge1N0cmluZ30gZmlsdGVycyBFLmc6IGNsdXN0ZXIubmFtZTogd2F6dWggQU5EIHJ1bGUuZ3JvdXBzOiB2dWxuZXJhYmlsaXR5XG4gKiBAcmV0dXJucyB7QXJyYXk8U3RyaW5nPn1cbiAqL1xuZXhwb3J0IGNvbnN0IHRvcFBDSVJlcXVpcmVtZW50cyA9IGFzeW5jIChcbiAgY29udGV4dCxcbiAgZ3RlLFxuICBsdGUsXG4gIGZpbHRlcnMsXG4gIGFsbG93ZWRBZ2VudHNGaWx0ZXIsXG4gIHBhdHRlcm4sXG4pID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBiYXNlID0ge307XG5cbiAgICBPYmplY3QuYXNzaWduKGJhc2UsIEJhc2UocGF0dGVybiwgZmlsdGVycywgZ3RlLCBsdGUsIGFsbG93ZWRBZ2VudHNGaWx0ZXIpKTtcblxuICAgIE9iamVjdC5hc3NpZ24oYmFzZS5hZ2dzLCB7XG4gICAgICAnMic6IHtcbiAgICAgICAgdGVybXM6IHtcbiAgICAgICAgICBmaWVsZDogJ3J1bGUucGNpX2RzcycsXG4gICAgICAgICAgc2l6ZTogNSxcbiAgICAgICAgICBvcmRlcjoge1xuICAgICAgICAgICAgX2NvdW50OiAnZGVzYycsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNvbnRleHQuY29yZS5vcGVuc2VhcmNoLmNsaWVudC5hc0N1cnJlbnRVc2VyLnNlYXJjaCh7XG4gICAgICBpbmRleDogcGF0dGVybixcbiAgICAgIGJvZHk6IGJhc2UsXG4gICAgfSk7XG4gICAgY29uc3QgeyBidWNrZXRzIH0gPSByZXNwb25zZS5ib2R5LmFnZ3JlZ2F0aW9uc1snMiddO1xuXG4gICAgcmV0dXJuIGJ1Y2tldHNcbiAgICAgIC5tYXAoaXRlbSA9PiBpdGVtLmtleSlcbiAgICAgIC5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgIGNvbnN0IGFfc3BsaXQgPSBhLnNwbGl0KCcuJyk7XG4gICAgICAgIGNvbnN0IGJfc3BsaXQgPSBiLnNwbGl0KCcuJyk7XG4gICAgICAgIGlmIChwYXJzZUludChhX3NwbGl0WzBdKSA+IHBhcnNlSW50KGJfc3BsaXRbMF0pKSByZXR1cm4gMTtcbiAgICAgICAgZWxzZSBpZiAocGFyc2VJbnQoYV9zcGxpdFswXSkgPCBwYXJzZUludChiX3NwbGl0WzBdKSkgcmV0dXJuIC0xO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBpZiAocGFyc2VJbnQoYV9zcGxpdFsxXSkgPiBwYXJzZUludChiX3NwbGl0WzFdKSkgcmV0dXJuIDE7XG4gICAgICAgICAgZWxzZSBpZiAocGFyc2VJbnQoYV9zcGxpdFsxXSkgPCBwYXJzZUludChiX3NwbGl0WzFdKSkgcmV0dXJuIC0xO1xuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHBhcnNlSW50KGFfc3BsaXRbMl0pID4gcGFyc2VJbnQoYl9zcGxpdFsyXSkpIHJldHVybiAxO1xuICAgICAgICAgICAgZWxzZSBpZiAocGFyc2VJbnQoYV9zcGxpdFsyXSkgPCBwYXJzZUludChiX3NwbGl0WzJdKSkgcmV0dXJuIC0xO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgfVxufTtcblxuLyoqXG4gKiBSZXR1cm5zIHRvcCAzIHJ1bGVzIGZvciBzcGVjaWZpYyBQQ0kgRFNTIHJlcXVpcmVtZW50XG4gKiBAcGFyYW0geyp9IGNvbnRleHQgRW5kcG9pbnQgY29udGV4dFxuICogQHBhcmFtIHtOdW1iZXJ9IGd0ZSBUaW1lc3RhbXAgKG1zKSBmcm9tXG4gKiBAcGFyYW0ge051bWJlcn0gbHRlIFRpbWVzdGFtcCAobXMpIHRvXG4gKiBAcGFyYW0ge1N0cmluZ30gcmVxdWlyZW1lbnQgUENJIERTUyByZXF1aXJlbWVudC4gRS5nOiAnMTAuMi4zJ1xuICogQHBhcmFtIHtTdHJpbmd9IGZpbHRlcnMgRS5nOiBjbHVzdGVyLm5hbWU6IHdhenVoIEFORCBydWxlLmdyb3VwczogdnVsbmVyYWJpbGl0eVxuICogQHJldHVybnMge0FycmF5PFN0cmluZz59XG4gKi9cbmV4cG9ydCBjb25zdCBnZXRSdWxlc0J5UmVxdWlyZW1lbnQgPSBhc3luYyAoXG4gIGNvbnRleHQsXG4gIGd0ZSxcbiAgbHRlLFxuICBmaWx0ZXJzLFxuICBhbGxvd2VkQWdlbnRzRmlsdGVyLFxuICByZXF1aXJlbWVudCxcbiAgcGF0dGVybixcbikgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGJhc2UgPSB7fTtcblxuICAgIE9iamVjdC5hc3NpZ24oYmFzZSwgQmFzZShwYXR0ZXJuLCBmaWx0ZXJzLCBndGUsIGx0ZSwgYWxsb3dlZEFnZW50c0ZpbHRlcikpO1xuXG4gICAgT2JqZWN0LmFzc2lnbihiYXNlLmFnZ3MsIHtcbiAgICAgICcyJzoge1xuICAgICAgICB0ZXJtczoge1xuICAgICAgICAgIGZpZWxkOiAncnVsZS5kZXNjcmlwdGlvbicsXG4gICAgICAgICAgc2l6ZTogMyxcbiAgICAgICAgICBvcmRlcjoge1xuICAgICAgICAgICAgX2NvdW50OiAnZGVzYycsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgYWdnczoge1xuICAgICAgICAgICczJzoge1xuICAgICAgICAgICAgdGVybXM6IHtcbiAgICAgICAgICAgICAgZmllbGQ6ICdydWxlLmlkJyxcbiAgICAgICAgICAgICAgc2l6ZTogMSxcbiAgICAgICAgICAgICAgb3JkZXI6IHtcbiAgICAgICAgICAgICAgICBfY291bnQ6ICdkZXNjJyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBiYXNlLnF1ZXJ5LmJvb2wuZmlsdGVyLnB1c2goe1xuICAgICAgbWF0Y2hfcGhyYXNlOiB7XG4gICAgICAgICdydWxlLnBjaV9kc3MnOiB7XG4gICAgICAgICAgcXVlcnk6IHJlcXVpcmVtZW50LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY29udGV4dC5jb3JlLm9wZW5zZWFyY2guY2xpZW50LmFzQ3VycmVudFVzZXIuc2VhcmNoKHtcbiAgICAgIGluZGV4OiBwYXR0ZXJuLFxuICAgICAgYm9keTogYmFzZSxcbiAgICB9KTtcbiAgICBjb25zdCB7IGJ1Y2tldHMgfSA9IHJlc3BvbnNlLmJvZHkuYWdncmVnYXRpb25zWycyJ107XG4gICAgcmV0dXJuIGJ1Y2tldHMucmVkdWNlKChhY2N1bSwgYnVja2V0KSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgICFidWNrZXQgfHxcbiAgICAgICAgIWJ1Y2tldFsnMyddIHx8XG4gICAgICAgICFidWNrZXRbJzMnXS5idWNrZXRzIHx8XG4gICAgICAgICFidWNrZXRbJzMnXS5idWNrZXRzWzBdIHx8XG4gICAgICAgICFidWNrZXRbJzMnXS5idWNrZXRzWzBdLmtleSB8fFxuICAgICAgICAhYnVja2V0LmtleVxuICAgICAgKSB7XG4gICAgICAgIHJldHVybiBhY2N1bTtcbiAgICAgIH1cbiAgICAgIGFjY3VtLnB1c2goe1xuICAgICAgICBydWxlSUQ6IGJ1Y2tldFsnMyddLmJ1Y2tldHNbMF0ua2V5LFxuICAgICAgICBydWxlRGVzY3JpcHRpb246IGJ1Y2tldC5rZXksXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBhY2N1bTtcbiAgICB9LCBbXSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgfVxufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBV0EsSUFBQUEsVUFBQSxHQUFBQyxPQUFBO0FBWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sTUFBTUMsa0JBQWtCLEdBQUcsTUFBQUEsQ0FDaENDLE9BQU8sRUFDUEMsR0FBRyxFQUNIQyxHQUFHLEVBQ0hDLE9BQU8sRUFDUEMsbUJBQW1CLEVBQ25CQyxPQUFPLEtBQ0o7RUFDSCxJQUFJO0lBQ0YsTUFBTUMsSUFBSSxHQUFHLENBQUMsQ0FBQztJQUVmQyxNQUFNLENBQUNDLE1BQU0sQ0FBQ0YsSUFBSSxFQUFFLElBQUFHLGVBQUksRUFBQ0osT0FBTyxFQUFFRixPQUFPLEVBQUVGLEdBQUcsRUFBRUMsR0FBRyxFQUFFRSxtQkFBbUIsQ0FBQyxDQUFDO0lBRTFFRyxNQUFNLENBQUNDLE1BQU0sQ0FBQ0YsSUFBSSxDQUFDSSxJQUFJLEVBQUU7TUFDdkIsR0FBRyxFQUFFO1FBQ0hDLEtBQUssRUFBRTtVQUNMQyxLQUFLLEVBQUUsY0FBYztVQUNyQkMsSUFBSSxFQUFFLENBQUM7VUFDUEMsS0FBSyxFQUFFO1lBQ0xDLE1BQU0sRUFBRTtVQUNWO1FBQ0Y7TUFDRjtJQUNGLENBQUMsQ0FBQztJQUVGLE1BQU1DLFFBQVEsR0FBRyxNQUFNaEIsT0FBTyxDQUFDaUIsSUFBSSxDQUFDQyxVQUFVLENBQUNDLE1BQU0sQ0FBQ0MsYUFBYSxDQUFDQyxNQUFNLENBQUM7TUFDekVDLEtBQUssRUFBRWpCLE9BQU87TUFDZGtCLElB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