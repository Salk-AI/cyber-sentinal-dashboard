"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.top3agents = exports.top3Rules = exports.lastTenModifiedFiles = exports.lastTenDeletedFiles = void 0;
var _baseQuery = require("./base-query");
/*
 * Wazuh app - Specific methods to fetch Wazuh syscheck data from Elasticsearch
 * Copyright (C) 2015-2022 Wazuh, Inc.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * Find more information about this on the LICENSE file.
 */

/**
 * Returns top 3 dangerous agents
 * @param {*} context Endpoint context
 * @param {Number} gte Timestamp (ms) from
 * @param {Number} lte Timestamp (ms) to
 * @param {String} filters E.g: cluster.name: wazuh AND rule.groups: vulnerability
 * @returns {Array<String>}
 */
const top3agents = async (context, gte, lte, filters, allowedAgentsFilter, pattern) => {
  try {
    const base = {};
    Object.assign(base, (0, _baseQuery.Base)(pattern, filters, gte, lte, allowedAgentsFilter));
    Object.assign(base.aggs, {
      '2': {
        terms: {
          field: 'agent.id',
          size: 3,
          order: {
            _count: 'desc'
          }
        }
      }
    });
    base.query.bool.must.push({
      range: {
        'rule.level': {
          gte: 7,
          lt: 16
        }
      }
    });
    const response = await context.core.opensearch.client.asCurrentUser.search({
      index: pattern,
      body: base
    });
    const {
      buckets
    } = response.body.aggregations['2'];
    return buckets.map(item => item.key);
  } catch (error) {
    return Promise.reject(error);
  }
};

/**
 * Returns top 3 rules
 * @param {Number} gte Timestamp (ms) from
 * @param {Number} lte Timestamp (ms) to
 * @param {String} filters E.g: cluster.name: wazuh AND rule.groups: vulnerability
 * @returns {Array<String>}
 */
exports.top3agents = top3agents;
const top3Rules = async (context, gte, lte, filters, allowedAgentsFilter, pattern) => {
  try {
    const base = {};
    Object.assign(base, (0, _baseQuery.Base)(pattern, filters, gte, lte, allowedAgentsFilter));
    Object.assign(base.aggs, {
      '2': {
        terms: {
          field: 'rule.description',
          size: 3,
          order: {
            _count: 'desc'
          }
        },
        aggs: {
          '3': {
            terms: {
              field: 'rule.id',
              size: 1,
              order: {
                _count: 'desc'
              }
            }
          }
        }
      }
    });
    const response = await context.core.opensearch.client.asCurrentUser.search({
      index: pattern,
      body: base
    });
    const {
      buckets
    } = response.body.aggregations['2'];
    return buckets.reduce((accum, bucket) => {
      if (!bucket || !bucket['3'] || !bucket['3'].buckets || !bucket['3'].buckets[0] || !bucket['3'].buckets[0].key || !bucket.key) {
        return accum;
      }
      accum.push({
        ruleID: bucket['3'].buckets[0].key,
        ruleDescription: bucket.key
      });
      return accum;
    }, []);
  } catch (error) {
    return Promise.reject(error);
  }
};
exports.top3Rules = top3Rules;
const lastTenDeletedFiles = async (context, gte, lte, filters, allowedAgentsFilter, pattern) => {
  try {
    const base = {};
    Object.assign(base, (0, _baseQuery.Base)(pattern, filters, gte, lte, allowedAgentsFilter));
    Object.assign(base.aggs, {
      '2': {
        terms: {
          field: 'syscheck.path',
          size: 10,
          order: {
            '1': 'desc'
          }
        },
        aggs: {
          '1': {
            max: {
              field: 'timestamp'
            }
          }
        }
      }
    });
    base.query.bool.must.push({
      match_phrase: {
        'syscheck.event': {
          query: 'deleted'
        }
      }
    });
    const response = await context.core.opensearch.client.asCurrentUser.search({
      index: pattern,
      body: base
    });
    const {
      buckets
    } = response.body.aggregations['2'];
    return buckets.map(item => ({
      date: item['1'].value_as_string,
      path: item.key
    })).sort((a, b) => a.date > b.date ? -1 : a.date < b.date ? 1 : 0);
  } catch (error) {
    return Promise.reject(error);
  }
};
exports.lastTenDeletedFiles = lastTenDeletedFiles;
const lastTenModifiedFiles = async (context, gte, lte, filters, allowedAgentsFilter, pattern) => {
  try {
    const base = {};
    Object.assign(base, (0, _baseQuery.Base)(pattern, filters, gte, lte, allowedAgentsFilter));
    Object.assign(base.aggs, {
      '2': {
        terms: {
          field: 'syscheck.path',
          size: 10,
          order: {
            '1': 'desc'
          }
        },
        aggs: {
          '1': {
            max: {
              field: 'timestamp'
            }
          }
        }
      }
    });
    base.query.bool.must.push({
      match_phrase: {
        'syscheck.event': {
          query: 'modified'
        }
      }
    });
    const response = await context.core.opensearch.client.asCurrentUser.search({
      index: pattern,
      body: base
    });
    const {
      buckets
    } = response.body.aggregations['2'];
    return buckets.map(item => ({
      date: item['1'].value_as_string,
      path: item.key
    })).sort((a, b) => a.date > b.date ? -1 : a.date < b.date ? 1 : 0);
  } catch (error) {
    return Promise.reject(error);
  }
};
exports.lastTenModifiedFiles = lastTenModifiedFiles;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmFzZVF1ZXJ5IiwicmVxdWlyZSIsInRvcDNhZ2VudHMiLCJjb250ZXh0IiwiZ3RlIiwibHRlIiwiZmlsdGVycyIsImFsbG93ZWRBZ2VudHNGaWx0ZXIiLCJwYXR0ZXJuIiwiYmFzZSIsIk9iamVjdCIsImFzc2lnbiIsIkJhc2UiLCJhZ2dzIiwidGVybXMiLCJmaWVsZCIsInNpemUiLCJvcmRlciIsIl9jb3VudCIsInF1ZXJ5IiwiYm9vbCIsIm11c3QiLCJwdXNoIiwicmFuZ2UiLCJsdCIsInJlc3BvbnNlIiwiY29yZSIsIm9wZW5zZWFyY2giLCJjbGllbnQiLCJhc0N1cnJlbnRVc2VyIiwic2VhcmNoIiwiaW5kZXgiLCJib2R5IiwiYnVja2V0cyIsImFnZ3JlZ2F0aW9ucyIsIm1hcCIsIml0ZW0iLCJrZXkiLCJlcnJvciIsIlByb21pc2UiLCJyZWplY3QiLCJleHBvcnRzIiwidG9wM1J1bGVzIiwicmVkdWNlIiwiYWNjdW0iLCJidWNrZXQiLCJydWxlSUQiLCJydWxlRGVzY3JpcHRpb24iLCJsYXN0VGVuRGVsZXRlZEZpbGVzIiwibWF4IiwibWF0Y2hfcGhyYXNlIiwiZGF0ZSIsInZhbHVlX2FzX3N0cmluZyIsInBhdGgiLCJzb3J0IiwiYSIsImIiLCJsYXN0VGVuTW9kaWZpZWRGaWxlcyJdLCJzb3VyY2VzIjpbInN5c2NoZWNrLXJlcXVlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIFdhenVoIGFwcCAtIFNwZWNpZmljIG1ldGhvZHMgdG8gZmV0Y2ggV2F6dWggc3lzY2hlY2sgZGF0YSBmcm9tIEVsYXN0aWNzZWFyY2hcbiAqIENvcHlyaWdodCAoQykgMjAxNS0yMDIyIFdhenVoLCBJbmMuXG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnlcbiAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5XG4gKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvclxuICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBGaW5kIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhpcyBvbiB0aGUgTElDRU5TRSBmaWxlLlxuICovXG5pbXBvcnQgeyBCYXNlIH0gZnJvbSAnLi9iYXNlLXF1ZXJ5JztcblxuLyoqXG4gKiBSZXR1cm5zIHRvcCAzIGRhbmdlcm91cyBhZ2VudHNcbiAqIEBwYXJhbSB7Kn0gY29udGV4dCBFbmRwb2ludCBjb250ZXh0XG4gKiBAcGFyYW0ge051bWJlcn0gZ3RlIFRpbWVzdGFtcCAobXMpIGZyb21cbiAqIEBwYXJhbSB7TnVtYmVyfSBsdGUgVGltZXN0YW1wIChtcykgdG9cbiAqIEBwYXJhbSB7U3RyaW5nfSBmaWx0ZXJzIEUuZzogY2x1c3Rlci5uYW1lOiB3YXp1aCBBTkQgcnVsZS5ncm91cHM6IHZ1bG5lcmFiaWxpdHlcbiAqIEByZXR1cm5zIHtBcnJheTxTdHJpbmc+fVxuICovXG5leHBvcnQgY29uc3QgdG9wM2FnZW50cyA9IGFzeW5jIChcbiAgY29udGV4dCxcbiAgZ3RlLFxuICBsdGUsXG4gIGZpbHRlcnMsXG4gIGFsbG93ZWRBZ2VudHNGaWx0ZXIsXG4gIHBhdHRlcm4sXG4pID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBiYXNlID0ge307XG5cbiAgICBPYmplY3QuYXNzaWduKGJhc2UsIEJhc2UocGF0dGVybiwgZmlsdGVycywgZ3RlLCBsdGUsIGFsbG93ZWRBZ2VudHNGaWx0ZXIpKTtcblxuICAgIE9iamVjdC5hc3NpZ24oYmFzZS5hZ2dzLCB7XG4gICAgICAnMic6IHtcbiAgICAgICAgdGVybXM6IHtcbiAgICAgICAgICBmaWVsZDogJ2FnZW50LmlkJyxcbiAgICAgICAgICBzaXplOiAzLFxuICAgICAgICAgIG9yZGVyOiB7XG4gICAgICAgICAgICBfY291bnQ6ICdkZXNjJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGJhc2UucXVlcnkuYm9vbC5tdXN0LnB1c2goe1xuICAgICAgcmFuZ2U6IHtcbiAgICAgICAgJ3J1bGUubGV2ZWwnOiB7XG4gICAgICAgICAgZ3RlOiA3LFxuICAgICAgICAgIGx0OiAxNixcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNvbnRleHQuY29yZS5vcGVuc2VhcmNoLmNsaWVudC5hc0N1cnJlbnRVc2VyLnNlYXJjaCh7XG4gICAgICBpbmRleDogcGF0dGVybixcbiAgICAgIGJvZHk6IGJhc2UsXG4gICAgfSk7XG4gICAgY29uc3QgeyBidWNrZXRzIH0gPSByZXNwb25zZS5ib2R5LmFnZ3JlZ2F0aW9uc1snMiddO1xuXG4gICAgcmV0dXJuIGJ1Y2tldHMubWFwKGl0ZW0gPT4gaXRlbS5rZXkpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gIH1cbn07XG5cbi8qKlxuICogUmV0dXJucyB0b3AgMyBydWxlc1xuICogQHBhcmFtIHtOdW1iZXJ9IGd0ZSBUaW1lc3RhbXAgKG1zKSBmcm9tXG4gKiBAcGFyYW0ge051bWJlcn0gbHRlIFRpbWVzdGFtcCAobXMpIHRvXG4gKiBAcGFyYW0ge1N0cmluZ30gZmlsdGVycyBFLmc6IGNsdXN0ZXIubmFtZTogd2F6dWggQU5EIHJ1bGUuZ3JvdXBzOiB2dWxuZXJhYmlsaXR5XG4gKiBAcmV0dXJucyB7QXJyYXk8U3RyaW5nPn1cbiAqL1xuZXhwb3J0IGNvbnN0IHRvcDNSdWxlcyA9IGFzeW5jIChcbiAgY29udGV4dCxcbiAgZ3RlLFxuICBsdGUsXG4gIGZpbHRlcnMsXG4gIGFsbG93ZWRBZ2VudHNGaWx0ZXIsXG4gIHBhdHRlcm4sXG4pID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBiYXNlID0ge307XG5cbiAgICBPYmplY3QuYXNzaWduKGJhc2UsIEJhc2UocGF0dGVybiwgZmlsdGVycywgZ3RlLCBsdGUsIGFsbG93ZWRBZ2VudHNGaWx0ZXIpKTtcblxuICAgIE9iamVjdC5hc3NpZ24oYmFzZS5hZ2dzLCB7XG4gICAgICAnMic6IHtcbiAgICAgICAgdGVybXM6IHtcbiAgICAgICAgICBmaWVsZDogJ3J1bGUuZGVzY3JpcHRpb24nLFxuICAgICAgICAgIHNpemU6IDMsXG4gICAgICAgICAgb3JkZXI6IHtcbiAgICAgICAgICAgIF9jb3VudDogJ2Rlc2MnLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGFnZ3M6IHtcbiAgICAgICAgICAnMyc6IHtcbiAgICAgICAgICAgIHRlcm1zOiB7XG4gICAgICAgICAgICAgIGZpZWxkOiAncnVsZS5pZCcsXG4gICAgICAgICAgICAgIHNpemU6IDEsXG4gICAgICAgICAgICAgIG9yZGVyOiB7XG4gICAgICAgICAgICAgICAgX2NvdW50OiAnZGVzYycsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjb250ZXh0LmNvcmUub3BlbnNlYXJjaC5jbGllbnQuYXNDdXJyZW50VXNlci5zZWFyY2goe1xuICAgICAgaW5kZXg6IHBhdHRlcm4sXG4gICAgICBib2R5OiBiYXNlLFxuICAgIH0pO1xuICAgIGNvbnN0IHsgYnVja2V0cyB9ID0gcmVzcG9uc2UuYm9keS5hZ2dyZWdhdGlvbnNbJzInXTtcbiAgICByZXR1cm4gYnVja2V0cy5yZWR1Y2UoKGFjY3VtLCBidWNrZXQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgIWJ1Y2tldCB8fFxuICAgICAgICAhYnVja2V0WyczJ10gfHxcbiAgICAgICAgIWJ1Y2tldFsnMyddLmJ1Y2tldHMgfHxcbiAgICAgICAgIWJ1Y2tldFsnMyddLmJ1Y2tldHNbMF0gfHxcbiAgICAgICAgIWJ1Y2tldFsnMyddLmJ1Y2tldHNbMF0ua2V5IHx8XG4gICAgICAgICFidWNrZXQua2V5XG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIGFjY3VtO1xuICAgICAgfVxuICAgICAgYWNjdW0ucHVzaCh7XG4gICAgICAgIHJ1bGVJRDogYnVja2V0WyczJ10uYnVja2V0c1swXS5rZXksXG4gICAgICAgIHJ1bGVEZXNjcmlwdGlvbjogYnVja2V0LmtleSxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFjY3VtO1xuICAgIH0sIFtdKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgbGFzdFRlbkRlbGV0ZWRGaWxlcyA9IGFzeW5jIChcbiAgY29udGV4dCxcbiAgZ3RlLFxuICBsdGUsXG4gIGZpbHRlcnMsXG4gIGFsbG93ZWRBZ2VudHNGaWx0ZXIsXG4gIHBhdHRlcm4sXG4pID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBiYXNlID0ge307XG5cbiAgICBPYmplY3QuYXNzaWduKGJhc2UsIEJhc2UocGF0dGVybiwgZmlsdGVycywgZ3RlLCBsdGUsIGFsbG93ZWRBZ2VudHNGaWx0ZXIpKTtcblxuICAgIE9iamVjdC5hc3NpZ24oYmFzZS5hZ2dzLCB7XG4gICAgICAnMic6IHtcbiAgICAgICAgdGVybXM6IHtcbiAgICAgICAgICBmaWVsZDogJ3N5c2NoZWNrLnBhdGgnLFxuICAgICAgICAgIHNpemU6IDEwLFxuICAgICAgICAgIG9yZGVyOiB7XG4gICAgICAgICAgICAnMSc6ICdkZXNjJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBhZ2dzOiB7XG4gICAgICAgICAgJzEnOiB7XG4gICAgICAgICAgICBtYXg6IHtcbiAgICAgICAgICAgICAgZmllbGQ6ICd0aW1lc3RhbXAnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGJhc2UucXVlcnkuYm9vbC5tdXN0LnB1c2goe1xuICAgICAgbWF0Y2hfcGhyYXNlOiB7XG4gICAgICAgICdzeXNjaGVjay5ldmVudCc6IHtcbiAgICAgICAgICBxdWVyeTogJ2RlbGV0ZWQnLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY29udGV4dC5jb3JlLm9wZW5zZWFyY2guY2xpZW50LmFzQ3VycmVudFVzZXIuc2VhcmNoKHtcbiAgICAgIGluZGV4OiBwYXR0ZXJuLFxuICAgICAgYm9keTogYmFzZSxcbiAgICB9KTtcbiAgICBjb25zdCB7IGJ1Y2tldHMgfSA9IHJlc3BvbnNlLmJvZHkuYWdncmVnYXRpb25zWycyJ107XG5cbiAgICByZXR1cm4gYnVja2V0c1xuICAgICAgLm1hcChpdGVtID0+ICh7IGRhdGU6IGl0ZW1bJzEnXS52YWx1ZV9hc19zdHJpbmcsIHBhdGg6IGl0ZW0ua2V5IH0pKVxuICAgICAgLnNvcnQoKGEsIGIpID0+IChhLmRhdGUgPiBiLmRhdGUgPyAtMSA6IGEuZGF0ZSA8IGIuZGF0ZSA/IDEgOiAwKSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGxhc3RUZW5Nb2RpZmllZEZpbGVzID0gYXN5bmMgKFxuICBjb250ZXh0LFxuICBndGUsXG4gIGx0ZSxcbiAgZmlsdGVycyxcbiAgYWxsb3dlZEFnZW50c0ZpbHRlcixcbiAgcGF0dGVybixcbikgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGJhc2UgPSB7fTtcblxuICAgIE9iamVjdC5hc3NpZ24oYmFzZSwgQmFzZShwYXR0ZXJuLCBmaWx0ZXJzLCBndGUsIGx0ZSwgYWxsb3dlZEFnZW50c0ZpbHRlcikpO1xuXG4gICAgT2JqZWN0LmFzc2lnbihiYXNlLmFnZ3MsIHtcbiAgICAgICcyJzoge1xuICAgICAgICB0ZXJtczoge1xuICAgICAgICAgIGZpZWxkOiAnc3lzY2hlY2sucGF0aCcsXG4gICAgICAgICAgc2l6ZTogMTAsXG4gICAgICAgICAgb3JkZXI6IHtcbiAgICAgICAgICAgICcxJzogJ2Rlc2MnLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGFnZ3M6IHtcbiAgICAgICAgICAnMSc6IHtcbiAgICAgICAgICAgIG1heDoge1xuICAgICAgICAgICAgICBmaWVsZDogJ3RpbWVzdGFtcCcsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgYmFzZS5xdWVyeS5ib29sLm11c3QucHVzaCh7XG4gICAgICBtYXRjaF9waHJhc2U6IHtcbiAgICAgICAgJ3N5c2NoZWNrLmV2ZW50Jzoge1xuICAgICAgICAgIHF1ZXJ5OiAnbW9kaWZpZWQnLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY29udGV4dC5jb3JlLm9wZW5zZWFyY2guY2xpZW50LmFzQ3VycmVudFVzZXIuc2VhcmNoKHtcbiAgICAgIGluZGV4OiBwYXR0ZXJuLFxuICAgICAgYm9keTogYmFzZSxcbiAgICB9KTtcbiAgICBjb25zdCB7IGJ1Y2tldHMgfSA9IHJlc3BvbnNlLmJvZHkuYWdncmVnYXRpb25zWycyJ107XG5cbiAgICByZXR1cm4gYnVja2V0c1xuICAgICAgLm1hcChpdGVtID0+ICh7IGRhdGU6IGl0ZW1bJzEnXS52YWx1ZV9hc19zdHJpbmcsIHBhdGg6IGl0ZW0ua2V5IH0pKVxuICAgICAgLnNvcnQoKGEsIGIpID0+IChhLmRhdGUgPiBiLmRhdGUgPyAtMSA6IGEuZGF0ZSA8IGIuZGF0ZSA/IDEgOiAwKSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgfVxufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBV0EsSUFBQUEsVUFBQSxHQUFBQyxPQUFBO0FBWEE7QUFDQTtBQUNBO0FB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