"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.topTSCRequirements = exports.getRulesByRequirement = void 0;
var _baseQuery = require("./base-query");
/*
 * Wazuh app - Specific methods to fetch Wazuh TSC data from Elasticsearch
 * Copyright (C) 2015-2022 Wazuh, Inc.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * Find more information about this on the LICENSE file.
 */

/**
 * Returns top 5 TSC requirements
 * @param {Number} context Endpoint context
 * @param {Number} gte Timestamp (ms) from
 * @param {Number} lte Timestamp (ms) to
 * @param {String} filters E.g: cluster.name: wazuh AND rule.groups: vulnerability
 * @returns {Array<String>}
 */
const topTSCRequirements = async (context, gte, lte, filters, allowedAgentsFilter, pattern) => {
  try {
    const base = {};
    Object.assign(base, (0, _baseQuery.Base)(pattern, filters, gte, lte, allowedAgentsFilter));
    Object.assign(base.aggs, {
      '2': {
        terms: {
          field: 'rule.tsc',
          size: 5,
          order: {
            _count: 'desc'
          }
        }
      }
    });
    const response = await context.core.opensearch.client.asCurrentUser.search({
      index: pattern,
      body: base
    });
    const {
      buckets
    } = response.body.aggregations['2'];
    return buckets.map(item => item.key).sort((a, b) => {
      const a_split = a.split('.');
      const b_split = b.split('.');
      if (parseInt(a_split[0]) > parseInt(b_split[0])) return 1;else if (parseInt(a_split[0]) < parseInt(b_split[0])) return -1;else {
        if (parseInt(a_split[1]) > parseInt(b_split[1])) return 1;else if (parseInt(a_split[1]) < parseInt(b_split[1])) return -1;else {
          if (parseInt(a_split[2]) > parseInt(b_split[2])) return 1;else if (parseInt(a_split[2]) < parseInt(b_split[2])) return -1;
        }
      }
    });
  } catch (error) {
    return Promise.reject(error);
  }
};

/**
 * Returns top 3 rules for specific TSC requirement
 * @param {*} context Endpoint context
 * @param {Number} gte Timestamp (ms) from
 * @param {Number} lte Timestamp (ms) to
 * @param {String} requirement TSCrequirement. E.g: 'CC7.2'
 * @param {String} filters E.g: cluster.name: wazuh AND rule.groups: vulnerability
 * @returns {Array<String>}
 */
exports.topTSCRequirements = topTSCRequirements;
const getRulesByRequirement = async (context, gte, lte, filters, allowedAgentsFilter, requirement, pattern) => {
  try {
    const base = {};
    Object.assign(base, (0, _baseQuery.Base)(pattern, filters, gte, lte, allowedAgentsFilter));
    Object.assign(base.aggs, {
      '2': {
        terms: {
          field: 'rule.description',
          size: 3,
          order: {
            _count: 'desc'
          }
        },
        aggs: {
          '3': {
            terms: {
              field: 'rule.id',
              size: 1,
              order: {
                _count: 'desc'
              }
            }
          }
        }
      }
    });
    base.query.bool.filter.push({
      match_phrase: {
        'rule.tsc': {
          query: requirement
        }
      }
    });
    const response = await context.core.opensearch.client.asCurrentUser.search({
      index: pattern,
      body: base
    });
    const {
      buckets
    } = response.body.aggregations['2'];
    return buckets.reduce((accum, bucket) => {
      if (!bucket || !bucket['3'] || !bucket['3'].buckets || !bucket['3'].buckets[0] || !bucket['3'].buckets[0].key || !bucket.key) {
        return accum;
      }
      accum.push({
        ruleID: bucket['3'].buckets[0].key,
        ruleDescription: bucket.key
      });
      return accum;
    }, []);
  } catch (error) {
    return Promise.reject(error);
  }
};
exports.getRulesByRequirement = getRulesByRequirement;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmFzZVF1ZXJ5IiwicmVxdWlyZSIsInRvcFRTQ1JlcXVpcmVtZW50cyIsImNvbnRleHQiLCJndGUiLCJsdGUiLCJmaWx0ZXJzIiwiYWxsb3dlZEFnZW50c0ZpbHRlciIsInBhdHRlcm4iLCJiYXNlIiwiT2JqZWN0IiwiYXNzaWduIiwiQmFzZSIsImFnZ3MiLCJ0ZXJtcyIsImZpZWxkIiwic2l6ZSIsIm9yZGVyIiwiX2NvdW50IiwicmVzcG9uc2UiLCJjb3JlIiwib3BlbnNlYXJjaCIsImNsaWVudCIsImFzQ3VycmVudFVzZXIiLCJzZWFyY2giLCJpbmRleCIsImJvZHkiLCJidWNrZXRzIiwiYWdncmVnYXRpb25zIiwibWFwIiwiaXRlbSIsImtleSIsInNvcnQiLCJhIiwiYiIsImFfc3BsaXQiLCJzcGxpdCIsImJfc3BsaXQiLCJwYXJzZUludCIsImVycm9yIiwiUHJvbWlzZSIsInJlamVjdCIsImV4cG9ydHMiLCJnZXRSdWxlc0J5UmVxdWlyZW1lbnQiLCJyZXF1aXJlbWVudCIsInF1ZXJ5IiwiYm9vbCIsImZpbHRlciIsInB1c2giLCJtYXRjaF9waHJhc2UiLCJyZWR1Y2UiLCJhY2N1bSIsImJ1Y2tldCIsInJ1bGVJRCIsInJ1bGVEZXNjcmlwdGlvbiJdLCJzb3VyY2VzIjpbInRzYy1yZXF1ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBXYXp1aCBhcHAgLSBTcGVjaWZpYyBtZXRob2RzIHRvIGZldGNoIFdhenVoIFRTQyBkYXRhIGZyb20gRWxhc3RpY3NlYXJjaFxuICogQ29weXJpZ2h0IChDKSAyMDE1LTIwMjIgV2F6dWgsIEluYy5cbiAqXG4gKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeVxuICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnlcbiAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yXG4gKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLlxuICpcbiAqIEZpbmQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGlzIG9uIHRoZSBMSUNFTlNFIGZpbGUuXG4gKi9cbmltcG9ydCB7IEJhc2UgfSBmcm9tICcuL2Jhc2UtcXVlcnknO1xuXG4vKipcbiAqIFJldHVybnMgdG9wIDUgVFNDIHJlcXVpcmVtZW50c1xuICogQHBhcmFtIHtOdW1iZXJ9IGNvbnRleHQgRW5kcG9pbnQgY29udGV4dFxuICogQHBhcmFtIHtOdW1iZXJ9IGd0ZSBUaW1lc3RhbXAgKG1zKSBmcm9tXG4gKiBAcGFyYW0ge051bWJlcn0gbHRlIFRpbWVzdGFtcCAobXMpIHRvXG4gKiBAcGFyYW0ge1N0cmluZ30gZmlsdGVycyBFLmc6IGNsdXN0ZXIubmFtZTogd2F6dWggQU5EIHJ1bGUuZ3JvdXBzOiB2dWxuZXJhYmlsaXR5XG4gKiBAcmV0dXJucyB7QXJyYXk8U3RyaW5nPn1cbiAqL1xuZXhwb3J0IGNvbnN0IHRvcFRTQ1JlcXVpcmVtZW50cyA9IGFzeW5jIChcbiAgY29udGV4dCxcbiAgZ3RlLFxuICBsdGUsXG4gIGZpbHRlcnMsXG4gIGFsbG93ZWRBZ2VudHNGaWx0ZXIsXG4gIHBhdHRlcm4sXG4pID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBiYXNlID0ge307XG5cbiAgICBPYmplY3QuYXNzaWduKGJhc2UsIEJhc2UocGF0dGVybiwgZmlsdGVycywgZ3RlLCBsdGUsIGFsbG93ZWRBZ2VudHNGaWx0ZXIpKTtcblxuICAgIE9iamVjdC5hc3NpZ24oYmFzZS5hZ2dzLCB7XG4gICAgICAnMic6IHtcbiAgICAgICAgdGVybXM6IHtcbiAgICAgICAgICBmaWVsZDogJ3J1bGUudHNjJyxcbiAgICAgICAgICBzaXplOiA1LFxuICAgICAgICAgIG9yZGVyOiB7XG4gICAgICAgICAgICBfY291bnQ6ICdkZXNjJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY29udGV4dC5jb3JlLm9wZW5zZWFyY2guY2xpZW50LmFzQ3VycmVudFVzZXIuc2VhcmNoKHtcbiAgICAgIGluZGV4OiBwYXR0ZXJuLFxuICAgICAgYm9keTogYmFzZSxcbiAgICB9KTtcbiAgICBjb25zdCB7IGJ1Y2tldHMgfSA9IHJlc3BvbnNlLmJvZHkuYWdncmVnYXRpb25zWycyJ107XG5cbiAgICByZXR1cm4gYnVja2V0c1xuICAgICAgLm1hcChpdGVtID0+IGl0ZW0ua2V5KVxuICAgICAgLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgY29uc3QgYV9zcGxpdCA9IGEuc3BsaXQoJy4nKTtcbiAgICAgICAgY29uc3QgYl9zcGxpdCA9IGIuc3BsaXQoJy4nKTtcbiAgICAgICAgaWYgKHBhcnNlSW50KGFfc3BsaXRbMF0pID4gcGFyc2VJbnQoYl9zcGxpdFswXSkpIHJldHVybiAxO1xuICAgICAgICBlbHNlIGlmIChwYXJzZUludChhX3NwbGl0WzBdKSA8IHBhcnNlSW50KGJfc3BsaXRbMF0pKSByZXR1cm4gLTE7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIGlmIChwYXJzZUludChhX3NwbGl0WzFdKSA+IHBhcnNlSW50KGJfc3BsaXRbMV0pKSByZXR1cm4gMTtcbiAgICAgICAgICBlbHNlIGlmIChwYXJzZUludChhX3NwbGl0WzFdKSA8IHBhcnNlSW50KGJfc3BsaXRbMV0pKSByZXR1cm4gLTE7XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAocGFyc2VJbnQoYV9zcGxpdFsyXSkgPiBwYXJzZUludChiX3NwbGl0WzJdKSkgcmV0dXJuIDE7XG4gICAgICAgICAgICBlbHNlIGlmIChwYXJzZUludChhX3NwbGl0WzJdKSA8IHBhcnNlSW50KGJfc3BsaXRbMl0pKSByZXR1cm4gLTE7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICB9XG59O1xuXG4vKipcbiAqIFJldHVybnMgdG9wIDMgcnVsZXMgZm9yIHNwZWNpZmljIFRTQyByZXF1aXJlbWVudFxuICogQHBhcmFtIHsqfSBjb250ZXh0IEVuZHBvaW50IGNvbnRleHRcbiAqIEBwYXJhbSB7TnVtYmVyfSBndGUgVGltZXN0YW1wIChtcykgZnJvbVxuICogQHBhcmFtIHtOdW1iZXJ9IGx0ZSBUaW1lc3RhbXAgKG1zKSB0b1xuICogQHBhcmFtIHtTdHJpbmd9IHJlcXVpcmVtZW50IFRTQ3JlcXVpcmVtZW50LiBFLmc6ICdDQzcuMidcbiAqIEBwYXJhbSB7U3RyaW5nfSBmaWx0ZXJzIEUuZzogY2x1c3Rlci5uYW1lOiB3YXp1aCBBTkQgcnVsZS5ncm91cHM6IHZ1bG5lcmFiaWxpdHlcbiAqIEByZXR1cm5zIHtBcnJheTxTdHJpbmc+fVxuICovXG5leHBvcnQgY29uc3QgZ2V0UnVsZXNCeVJlcXVpcmVtZW50ID0gYXN5bmMgKFxuICBjb250ZXh0LFxuICBndGUsXG4gIGx0ZSxcbiAgZmlsdGVycyxcbiAgYWxsb3dlZEFnZW50c0ZpbHRlcixcbiAgcmVxdWlyZW1lbnQsXG4gIHBhdHRlcm4sXG4pID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBiYXNlID0ge307XG5cbiAgICBPYmplY3QuYXNzaWduKGJhc2UsIEJhc2UocGF0dGVybiwgZmlsdGVycywgZ3RlLCBsdGUsIGFsbG93ZWRBZ2VudHNGaWx0ZXIpKTtcblxuICAgIE9iamVjdC5hc3NpZ24oYmFzZS5hZ2dzLCB7XG4gICAgICAnMic6IHtcbiAgICAgICAgdGVybXM6IHtcbiAgICAgICAgICBmaWVsZDogJ3J1bGUuZGVzY3JpcHRpb24nLFxuICAgICAgICAgIHNpemU6IDMsXG4gICAgICAgICAgb3JkZXI6IHtcbiAgICAgICAgICAgIF9jb3VudDogJ2Rlc2MnLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGFnZ3M6IHtcbiAgICAgICAgICAnMyc6IHtcbiAgICAgICAgICAgIHRlcm1zOiB7XG4gICAgICAgICAgICAgIGZpZWxkOiAncnVsZS5pZCcsXG4gICAgICAgICAgICAgIHNpemU6IDEsXG4gICAgICAgICAgICAgIG9yZGVyOiB7XG4gICAgICAgICAgICAgICAgX2NvdW50OiAnZGVzYycsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgYmFzZS5xdWVyeS5ib29sLmZpbHRlci5wdXNoKHtcbiAgICAgIG1hdGNoX3BocmFzZToge1xuICAgICAgICAncnVsZS50c2MnOiB7XG4gICAgICAgICAgcXVlcnk6IHJlcXVpcmVtZW50LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY29udGV4dC5jb3JlLm9wZW5zZWFyY2guY2xpZW50LmFzQ3VycmVudFVzZXIuc2VhcmNoKHtcbiAgICAgIGluZGV4OiBwYXR0ZXJuLFxuICAgICAgYm9keTogYmFzZSxcbiAgICB9KTtcbiAgICBjb25zdCB7IGJ1Y2tldHMgfSA9IHJlc3BvbnNlLmJvZHkuYWdncmVnYXRpb25zWycyJ107XG5cbiAgICByZXR1cm4gYnVja2V0cy5yZWR1Y2UoKGFjY3VtLCBidWNrZXQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgIWJ1Y2tldCB8fFxuICAgICAgICAhYnVja2V0WyczJ10gfHxcbiAgICAgICAgIWJ1Y2tldFsnMyddLmJ1Y2tldHMgfHxcbiAgICAgICAgIWJ1Y2tldFsnMyddLmJ1Y2tldHNbMF0gfHxcbiAgICAgICAgIWJ1Y2tldFsnMyddLmJ1Y2tldHNbMF0ua2V5IHx8XG4gICAgICAgICFidWNrZXQua2V5XG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIGFjY3VtO1xuICAgICAgfVxuICAgICAgYWNjdW0ucHVzaCh7XG4gICAgICAgIHJ1bGVJRDogYnVja2V0WyczJ10uYnVja2V0c1swXS5rZXksXG4gICAgICAgIHJ1bGVEZXNjcmlwdGlvbjogYnVja2V0LmtleSxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFjY3VtO1xuICAgIH0sIFtdKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICB9XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFXQSxJQUFBQSxVQUFBLEdBQUFDLE9BQUE7QUFYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyxNQUFNQyxrQkFBa0IsR0FBRyxNQUFBQSxDQUNoQ0MsT0FBTyxFQUNQQyxHQUFHLEVBQ0hDLEdBQUcsRUFDSEMsT0FBTyxFQUNQQyxtQkFBbUIsRUFDbkJDLE9BQU8sS0FDSjtFQUNILElBQUk7SUFDRixNQUFNQyxJQUFJLEdBQUcsQ0FBQyxDQUFDO0lBRWZDLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDRixJQUFJLEVBQUUsSUFBQUcsZUFBSSxFQUFDSixPQUFPLEVBQUVGLE9BQU8sRUFBRUYsR0FBRyxFQUFFQyxHQUFHLEVBQUVFLG1CQUFtQixDQUFDLENBQUM7SUFFMUVHLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDRixJQUFJLENBQUNJLElBQUksRUFBRTtNQUN2QixHQUFHLEVBQUU7UUFDSEMsS0FBSyxFQUFFO1VBQ0xDLEtBQUssRUFBRSxVQUFVO1VBQ2pCQyxJQUFJLEVBQUUsQ0FBQztVQUNQQyxLQUFLLEVBQUU7WUFDTEMsTUFBTSxFQUFFO1VBQ1Y7UUFDRjtNQUNGO0lBQ0YsQ0FBQyxDQUFDO0lBRUYsTUFBTUMsUUFBUSxHQUFHLE1BQU1oQixPQUFPLENBQUNpQixJQUFJLENBQUNDLFVBQVUsQ0FBQ0MsTUFBTSxDQUFDQyxhQUFhLENBQUNDLE1BQU0sQ0FBQztNQUN6RUMsS0FBSyxFQUFFakIsT0FBTztNQUNka0IsSUFBSSxFQUFFakI7SUFDUixDQUFD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