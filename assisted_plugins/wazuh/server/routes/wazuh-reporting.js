"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.WazuhReportingRoutes = WazuhReportingRoutes;
var _controllers = require("../controllers");
var _configSchema = require("@osd/config-schema");
/*
 * Wazuh app - Module for Wazuh reporting routes
 * Copyright (C) 2015-2022 Wazuh, Inc.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * Find more information about this on the LICENSE file.
 */

function WazuhReportingRoutes(router) {
  const ctrl = new _controllers.WazuhReportingCtrl();
  const agentIDValidation = _configSchema.schema.string({
    minLength: 3,
    validate: agentID => /^\d{3,}$/.test(agentID) ? undefined : 'must be 0-9 are allowed'
  });
  const groupIDValidation = _configSchema.schema.string({
    minLength: 1,
    validate: agentID => /^(?!^(\.{1,2}|all)$)[\w\.\-]+$/.test(agentID) ? undefined : 'must be A-z, 0-9, _, . are allowed. It must not be ., .. or all.'
  });
  const ReportFilenameValidation = _configSchema.schema.string({
    validate: agentID => /^[\w\-\.]+\.pdf$/.test(agentID) ? undefined : 'must be A-z, 0-9, _, ., and - are allowed. It must end with .pdf.'
  });
  const moduleIDValidation = _configSchema.schema.oneOf([_configSchema.schema.literal('general'), _configSchema.schema.literal('fim'), _configSchema.schema.literal('aws'), _configSchema.schema.literal('gcp'), _configSchema.schema.literal('pm'), _configSchema.schema.literal('audit'), _configSchema.schema.literal('sca'), _configSchema.schema.literal('office'), _configSchema.schema.literal('github'), _configSchema.schema.literal('ciscat'), _configSchema.schema.literal('vuls'), _configSchema.schema.literal('mitre'), _configSchema.schema.literal('virustotal'), _configSchema.schema.literal('docker'), _configSchema.schema.literal('osquery'), _configSchema.schema.literal('oscap'), _configSchema.schema.literal('pci'), _configSchema.schema.literal('hipaa'), _configSchema.schema.literal('nist'), _configSchema.schema.literal('gdpr'), _configSchema.schema.literal('tsc')]);
  router.post({
    path: '/reports/modules/{moduleID}',
    validate: {
      body: _configSchema.schema.object({
        array: _configSchema.schema.any(),
        browserTimezone: _configSchema.schema.string(),
        serverSideQuery: _configSchema.schema.maybe(_configSchema.schema.any()),
        filters: _configSchema.schema.maybe(_configSchema.schema.any()),
        agents: _configSchema.schema.maybe(_configSchema.schema.oneOf([agentIDValidation, _configSchema.schema.boolean()])),
        components: _configSchema.schema.maybe(_configSchema.schema.any()),
        searchBar: _configSchema.schema.maybe(_configSchema.schema.string()),
        section: _configSchema.schema.maybe(_configSchema.schema.string()),
        tab: _configSchema.schema.string(),
        tables: _configSchema.schema.maybe(_configSchema.schema.any()),
        time: _configSchema.schema.oneOf([_configSchema.schema.object({
          from: _configSchema.schema.string(),
          to: _configSchema.schema.string()
        }), _configSchema.schema.string()]),
        indexPatternTitle: _configSchema.schema.string(),
        apiId: _configSchema.schema.string()
      }),
      params: _configSchema.schema.object({
        moduleID: moduleIDValidation
      })
    }
  }, (context, request, response) => ctrl.createReportsModules(context, request, response));
  router.post({
    path: '/reports/groups/{groupID}',
    validate: {
      body: _configSchema.schema.object({
        browserTimezone: _configSchema.schema.string(),
        filters: _configSchema.schema.maybe(_configSchema.schema.any()),
        components: _configSchema.schema.maybe(_configSchema.schema.any()),
        section: _configSchema.schema.maybe(_configSchema.schema.string()),
        apiId: _configSchema.schema.string()
      }),
      params: _configSchema.schema.object({
        groupID: groupIDValidation
      })
    }
  }, (context, request, response) => ctrl.createReportsGroups(context, request, response));
  router.post({
    path: '/reports/agents/{agentID}',
    validate: {
      body: _configSchema.schema.object({
        browserTimezone: _configSchema.schema.string(),
        filters: _configSchema.schema.any(),
        components: _configSchema.schema.maybe(_configSchema.schema.any()),
        section: _configSchema.schema.maybe(_configSchema.schema.string()),
        apiId: _configSchema.schema.string()
      }),
      params: _configSchema.schema.object({
        agentID: agentIDValidation
      })
    }
  }, (context, request, response) => ctrl.createReportsAgentsConfiguration(context, request, response));
  router.post({
    path: '/reports/agents/{agentID}/inventory',
    validate: {
      body: _configSchema.schema.object({
        array: _configSchema.schema.any(),
        browserTimezone: _configSchema.schema.string(),
        serverSideQuery: _configSchema.schema.maybe(_configSchema.schema.any()),
        filters: _configSchema.schema.maybe(_configSchema.schema.any()),
        agents: _configSchema.schema.maybe(_configSchema.schema.oneOf([_configSchema.schema.string(), _configSchema.schema.boolean()])),
        components: _configSchema.schema.maybe(_configSchema.schema.any()),
        searchBar: _configSchema.schema.maybe(_configSchema.schema.oneOf([_configSchema.schema.string(), _configSchema.schema.boolean()])),
        section: _configSchema.schema.maybe(_configSchema.schema.string()),
        tab: _configSchema.schema.string(),
        tables: _configSchema.schema.maybe(_configSchema.schema.any()),
        time: _configSchema.schema.oneOf([_configSchema.schema.object({
          from: _configSchema.schema.string(),
          to: _configSchema.schema.string()
        }), _configSchema.schema.string()]),
        indexPatternTitle: _configSchema.schema.string(),
        apiId: _configSchema.schema.string()
      }),
      params: _configSchema.schema.object({
        agentID: agentIDValidation
      })
    }
  }, (context, request, response) => ctrl.createReportsAgentsInventory(context, request, response));

  // Fetch specific report
  router.get({
    path: '/reports/{name}',
    validate: {
      params: _configSchema.schema.object({
        name: ReportFilenameValidation
      })
    }
  }, (context, request, response) => ctrl.getReportByName(context, request, response));

  // Delete specific report
  router.delete({
    path: '/reports/{name}',
    validate: {
      params: _configSchema.schema.object({
        name: ReportFilenameValidation
      })
    }
  }, (context, request, response) => ctrl.deleteReportByName(context, request, response));

  // Fetch the reports list
  router.get({
    path: '/reports',
    validate: false
  }, (context, request, response) => ctrl.getReports(context, request, response));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY29udHJvbGxlcnMiLCJyZXF1aXJlIiwiX2NvbmZpZ1NjaGVtYSIsIldhenVoUmVwb3J0aW5nUm91dGVzIiwicm91dGVyIiwiY3RybCIsIldhenVoUmVwb3J0aW5nQ3RybCIsImFnZW50SURWYWxpZGF0aW9uIiwic2NoZW1hIiwic3RyaW5nIiwibWluTGVuZ3RoIiwidmFsaWRhdGUiLCJhZ2VudElEIiwidGVzdCIsInVuZGVmaW5lZCIsImdyb3VwSURWYWxpZGF0aW9uIiwiUmVwb3J0RmlsZW5hbWVWYWxpZGF0aW9uIiwibW9kdWxlSURWYWxpZGF0aW9uIiwib25lT2YiLCJsaXRlcmFsIiwicG9zdCIsInBhdGgiLCJib2R5Iiwib2JqZWN0IiwiYXJyYXkiLCJhbnkiLCJicm93c2VyVGltZXpvbmUiLCJzZXJ2ZXJTaWRlUXVlcnkiLCJtYXliZSIsImZpbHRlcnMiLCJhZ2VudHMiLCJib29sZWFuIiwiY29tcG9uZW50cyIsInNlYXJjaEJhciIsInNlY3Rpb24iLCJ0YWIiLCJ0YWJsZXMiLCJ0aW1lIiwiZnJvbSIsInRvIiwiaW5kZXhQYXR0ZXJuVGl0bGUiLCJhcGlJZCIsInBhcmFtcyIsIm1vZHVsZUlEIiwiY29udGV4dCIsInJlcXVlc3QiLCJyZXNwb25zZSIsImNyZWF0ZVJlcG9ydHNNb2R1bGVzIiwiZ3JvdXBJRCIsImNyZWF0ZVJlcG9ydHNHcm91cHMiLCJjcmVhdGVSZXBvcnRzQWdlbnRzQ29uZmlndXJhdGlvbiIsImNyZWF0ZVJlcG9ydHNBZ2VudHNJbnZlbnRvcnkiLCJnZXQiLCJuYW1lIiwiZ2V0UmVwb3J0QnlOYW1lIiwiZGVsZXRlIiwiZGVsZXRlUmVwb3J0QnlOYW1lIiwiZ2V0UmVwb3J0cyJdLCJzb3VyY2VzIjpbIndhenVoLXJlcG9ydGluZy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogV2F6dWggYXBwIC0gTW9kdWxlIGZvciBXYXp1aCByZXBvcnRpbmcgcm91dGVzXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTUtMjAyMiBXYXp1aCwgSW5jLlxuICpcbiAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5XG4gKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieVxuICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3JcbiAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogRmluZCBtb3JlIGluZm9ybWF0aW9uIGFib3V0IHRoaXMgb24gdGhlIExJQ0VOU0UgZmlsZS5cbiAqL1xuaW1wb3J0IHsgV2F6dWhSZXBvcnRpbmdDdHJsIH0gZnJvbSAnLi4vY29udHJvbGxlcnMnO1xuaW1wb3J0IHsgSVJvdXRlciB9IGZyb20gJ29wZW5zZWFyY2hfZGFzaGJvYXJkcy9zZXJ2ZXInO1xuaW1wb3J0IHsgc2NoZW1hIH0gZnJvbSAnQG9zZC9jb25maWctc2NoZW1hJztcblxuZXhwb3J0IGZ1bmN0aW9uIFdhenVoUmVwb3J0aW5nUm91dGVzKHJvdXRlcjogSVJvdXRlcikge1xuICBjb25zdCBjdHJsID0gbmV3IFdhenVoUmVwb3J0aW5nQ3RybCgpO1xuXG4gIGNvbnN0IGFnZW50SURWYWxpZGF0aW9uID0gc2NoZW1hLnN0cmluZyh7XG4gICAgbWluTGVuZ3RoOiAzLFxuICAgIHZhbGlkYXRlOiAoYWdlbnRJRDogc3RyaW5nKSA9PiAvXlxcZHszLH0kLy50ZXN0KGFnZW50SUQpID8gdW5kZWZpbmVkIDogJ211c3QgYmUgMC05IGFyZSBhbGxvd2VkJ1xuICB9KTtcblxuICBjb25zdCBncm91cElEVmFsaWRhdGlvbiA9IHNjaGVtYS5zdHJpbmcoe1xuICAgIG1pbkxlbmd0aDogMSxcbiAgICB2YWxpZGF0ZTogKGFnZW50SUQ6IHN0cmluZykgPT4gL14oPyFeKFxcLnsxLDJ9fGFsbCkkKVtcXHdcXC5cXC1dKyQvLnRlc3QoYWdlbnRJRCkgPyB1bmRlZmluZWQgOiAnbXVzdCBiZSBBLXosIDAtOSwgXywgLiBhcmUgYWxsb3dlZC4gSXQgbXVzdCBub3QgYmUgLiwgLi4gb3IgYWxsLidcbiAgfSk7XG5cbiAgY29uc3QgUmVwb3J0RmlsZW5hbWVWYWxpZGF0aW9uID0gc2NoZW1hLnN0cmluZyh7XG4gICAgdmFsaWRhdGU6IChhZ2VudElEOiBzdHJpbmcpID0+IC9eW1xcd1xcLVxcLl0rXFwucGRmJC8udGVzdChhZ2VudElEKSA/IHVuZGVmaW5lZCA6ICdtdXN0IGJlIEEteiwgMC05LCBfLCAuLCBhbmQgLSBhcmUgYWxsb3dlZC4gSXQgbXVzdCBlbmQgd2l0aCAucGRmLidcbiAgfSk7XG5cbiAgY29uc3QgbW9kdWxlSURWYWxpZGF0aW9uID0gc2NoZW1hLm9uZU9mKFtcbiAgICBzY2hlbWEubGl0ZXJhbCgnZ2VuZXJhbCcpLFxuICAgIHNjaGVtYS5saXRlcmFsKCdmaW0nKSxcbiAgICBzY2hlbWEubGl0ZXJhbCgnYXdzJyksXG4gICAgc2NoZW1hLmxpdGVyYWwoJ2djcCcpLFxuICAgIHNjaGVtYS5saXRlcmFsKCdwbScpLFxuICAgIHNjaGVtYS5saXRlcmFsKCdhdWRpdCcpLFxuICAgIHNjaGVtYS5saXRlcmFsKCdzY2EnKSxcbiAgICBzY2hlbWEubGl0ZXJhbCgnb2ZmaWNlJyksXG4gICAgc2NoZW1hLmxpdGVyYWwoJ2dpdGh1YicpLFxuICAgIHNjaGVtYS5saXRlcmFsKCdjaXNjYXQnKSxcbiAgICBzY2hlbWEubGl0ZXJhbCgndnVscycpLFxuICAgIHNjaGVtYS5saXRlcmFsKCdtaXRyZScpLFxuICAgIHNjaGVtYS5saXRlcmFsKCd2aXJ1c3RvdGFsJyksXG4gICAgc2NoZW1hLmxpdGVyYWwoJ2RvY2tlcicpLFxuICAgIHNjaGVtYS5saXRlcmFsKCdvc3F1ZXJ5JyksXG4gICAgc2NoZW1hLmxpdGVyYWwoJ29zY2FwJyksXG4gICAgc2NoZW1hLmxpdGVyYWwoJ3BjaScpLFxuICAgIHNjaGVtYS5saXRlcmFsKCdoaXBhYScpLFxuICAgIHNjaGVtYS5saXRlcmFsKCduaXN0JyksXG4gICAgc2NoZW1hLmxpdGVyYWwoJ2dkcHInKSxcbiAgICBzY2hlbWEubGl0ZXJhbCgndHNjJyksXG4gIF0pO1xuXG4gIHJvdXRlci5wb3N0KHtcbiAgICBwYXRoOiAnL3JlcG9ydHMvbW9kdWxlcy97bW9kdWxlSUR9JyxcbiAgICB2YWxpZGF0ZToge1xuICAgICAgYm9keTogc2NoZW1hLm9iamVjdCh7XG4gICAgICAgIGFycmF5OiBzY2hlbWEuYW55KCksXG4gICAgICAgIGJyb3dzZXJUaW1lem9uZTogc2NoZW1hLnN0cmluZygpLFxuICAgICAgICBzZXJ2ZXJTaWRlUXVlcnk6IHNjaGVtYS5tYXliZShzY2hlbWEuYW55KCkpLFxuICAgICAgICBmaWx0ZXJzOiBzY2hlbWEubWF5YmUoc2NoZW1hLmFueSgpKSxcbiAgICAgICAgYWdlbnRzOiBzY2hlbWEubWF5YmUoc2NoZW1hLm9uZU9mKFthZ2VudElEVmFsaWRhdGlvbiwgc2NoZW1hLmJvb2xlYW4oKV0pKSxcbiAgICAgICAgY29tcG9uZW50czogc2NoZW1hLm1heWJlKHNjaGVtYS5hbnkoKSksXG4gICAgICAgIHNlYXJjaEJhcjogc2NoZW1hLm1heWJlKHNjaGVtYS5zdHJpbmcoKSksXG4gICAgICAgIHNlY3Rpb246IHNjaGVtYS5tYXliZShzY2hlbWEuc3RyaW5nKCkpLFxuICAgICAgICB0YWI6IHNjaGVtYS5zdHJpbmcoKSxcbiAgICAgICAgdGFibGVzOiBzY2hlbWEubWF5YmUoc2NoZW1hLmFueSgpKSxcbiAgICAgICAgdGltZTogc2NoZW1hLm9uZU9mKFtzY2hlbWEub2JqZWN0KHtcbiAgICAgICAgICBmcm9tOiBzY2hlbWEuc3RyaW5nKCksXG4gICAgICAgICAgdG86IHNjaGVtYS5zdHJpbmcoKVxuICAgICAgICB9KSwgc2NoZW1hLnN0cmluZygpXSksXG4gICAgICAgIGluZGV4UGF0dGVyblRpdGxlOiBzY2hlbWEuc3RyaW5nKCksXG4gICAgICAgIGFwaUlkOiBzY2hlbWEuc3RyaW5nKClcbiAgICAgIH0pLFxuICAgICAgcGFyYW1zOiBzY2hlbWEub2JqZWN0KHtcbiAgICAgICAgbW9kdWxlSUQ6IG1vZHVsZUlEVmFsaWRhdGlvblxuICAgICAgfSlcbiAgICB9XG4gIH0sXG4gICAgKGNvbnRleHQsIHJlcXVlc3QsIHJlc3BvbnNlKSA9PiBjdHJsLmNyZWF0ZVJlcG9ydHNNb2R1bGVzKGNvbnRleHQsIHJlcXVlc3QsIHJlc3BvbnNlKVxuICApO1xuXG4gIHJvdXRlci5wb3N0KHtcbiAgICBwYXRoOiAnL3JlcG9ydHMvZ3JvdXBzL3tncm91cElEfScsXG4gICAgdmFsaWRhdGU6IHtcbiAgICAgIGJvZHk6IHNjaGVtYS5vYmplY3Qoe1xuICAgICAgICBicm93c2VyVGltZXpvbmU6IHNjaGVtYS5zdHJpbmcoKSxcbiAgICAgICAgZmlsdGVyczogc2NoZW1hLm1heWJlKHNjaGVtYS5hbnkoKSksXG4gICAgICAgIGNvbXBvbmVudHM6IHNjaGVtYS5tYXliZShzY2hlbWEuYW55KCkpLFxuICAgICAgICBzZWN0aW9uOiBzY2hlbWEubWF5YmUoc2NoZW1hLnN0cmluZygpKSxcbiAgICAgICAgYXBpSWQ6IHNjaGVtYS5zdHJpbmcoKVxuICAgICAgfSksXG4gICAgICBwYXJhbXM6IHNjaGVtYS5vYmplY3Qoe1xuICAgICAgICBncm91cElEOiBncm91cElEVmFsaWRhdGlvblxuICAgICAgfSlcbiAgICB9XG4gIH0sXG4gICAgKGNvbnRleHQsIHJlcXVlc3QsIHJlc3BvbnNlKSA9PiBjdHJsLmNyZWF0ZVJlcG9ydHNHcm91cHMoY29udGV4dCwgcmVxdWVzdCwgcmVzcG9uc2UpXG4gICk7XG5cbiAgcm91dGVyLnBvc3Qoe1xuICAgIHBhdGg6ICcvcmVwb3J0cy9hZ2VudHMve2FnZW50SUR9JyxcbiAgICB2YWxpZGF0ZToge1xuICAgICAgYm9keTogc2NoZW1hLm9iamVjdCh7XG4gICAgICAgIGJyb3dzZXJUaW1lem9uZTogc2NoZW1hLnN0cmluZygpLFxuICAgICAgICBmaWx0ZXJzOiBzY2hlbWEuYW55KCksXG4gICAgICAgIGNvbXBvbmVudHM6IHNjaGVtYS5tYXliZShzY2hlbWEuYW55KCkpLFxuICAgICAgICBzZWN0aW9uOiBzY2hlbWEubWF5YmUoc2NoZW1hLnN0cmluZygpKSxcbiAgICAgICAgYXBpSWQ6IHNjaGVtYS5zdHJpbmcoKVxuICAgICAgfSksXG4gICAgICBwYXJhbXM6IHNjaGVtYS5vYmplY3Qoe1xuICAgICAgICBhZ2VudElEOiBhZ2VudElEVmFsaWRhdGlvblxuICAgICAgfSlcbiAgICB9XG4gIH0sXG4gICAgKGNvbnRleHQsIHJlcXVlc3QsIHJlc3BvbnNlKSA9PiBjdHJsLmNyZWF0ZVJlcG9ydHNBZ2VudHNDb25maWd1cmF0aW9uKGNvbnRleHQsIHJlcXVlc3QsIHJlc3BvbnNlKVxuICApO1xuXG4gIHJvdXRlci5wb3N0KHtcbiAgICBwYXRoOiAnL3JlcG9ydHMvYWdlbnRzL3thZ2VudElEfS9pbnZlbnRvcnknLFxuICAgIHZhbGlkYXRlOiB7XG4gICAgICBib2R5OiBzY2hlbWEub2JqZWN0KHtcbiAgICAgICAgYXJyYXk6IHNjaGVtYS5hbnkoKSxcbiAgICAgICAgYnJvd3NlclRpbWV6b25lOiBzY2hlbWEuc3RyaW5nKCksXG4gICAgICAgIHNlcnZlclNpZGVRdWVyeTogc2NoZW1hLm1heWJlKHNjaGVtYS5hbnkoKSksXG4gICAgICAgIGZpbHRlcnM6IHNjaGVtYS5tYXliZShzY2hlbWEuYW55KCkpLFxuICAgICAgICBhZ2VudHM6IHNjaGVtYS5tYXliZShzY2hlbWEub25lT2YoW3NjaGVtYS5zdHJpbmcoKSwgc2NoZW1hLmJvb2xlYW4oKV0pKSxcbiAgICAgICAgY29tcG9uZW50czogc2NoZW1hLm1heWJlKHNjaGVtYS5hbnkoKSksXG4gICAgICAgIHNlYXJjaEJhcjogc2NoZW1hLm1heWJlKHNjaGVtYS5vbmVPZihbc2NoZW1hLnN0cmluZygpLCBzY2hlbWEuYm9vbGVhbigpXSkpLFxuICAgICAgICBzZWN0aW9uOiBzY2hlbWEubWF5YmUoc2NoZW1hLnN0cmluZygpKSxcbiAgICAgICAgdGFiOiBzY2hlbWEuc3RyaW5nKCksXG4gICAgICAgIHRhYmxlczogc2NoZW1hLm1heWJlKHNjaGVtYS5hbnkoKSksXG4gICAgICAgIHRpbWU6IHNjaGVtYS5vbmVPZihbc2NoZW1hLm9iamVjdCh7XG4gICAgICAgICAgZnJvbTogc2NoZW1hLnN0cmluZygpLFxuICAgICAgICAgIHRvOiBzY2hlbWEuc3RyaW5nKClcbiAgICAgICAgfSksIHNjaGVtYS5zdHJpbmcoKV0pLFxuICAgICAgICBpbmRleFBhdHRlcm5UaXRsZTogc2NoZW1hLnN0cmluZygpLFxuICAgICAgICBhcGlJZDogc2NoZW1hLnN0cmluZygpXG4gICAgICB9KSxcbiAgICAgIHBhcmFtczogc2NoZW1hLm9iamVjdCh7XG4gICAgICAgIGFnZW50SUQ6IGFnZW50SURWYWxpZGF0aW9uXG4gICAgICB9KVxuICAgIH1cbiAgfSxcbiAgICAoY29udGV4dCwgcmVxdWVzdCwgcmVzcG9uc2UpID0+IGN0cmwuY3JlYXRlUmVwb3J0c0FnZW50c0ludmVudG9yeShjb250ZXh0LCByZXF1ZXN0LCByZXNwb25zZSlcbiAgKTtcblxuICAvLyBGZXRjaCBzcGVjaWZpYyByZXBvcnRcbiAgcm91dGVyLmdldCh7XG4gICAgcGF0aDogJy9yZXBvcnRzL3tuYW1lfScsXG4gICAgdmFsaWRhdGU6IHtcbiAgICAgIHBhcmFtczogc2NoZW1hLm9iamVjdCh7XG4gICAgICAgIG5hbWU6IFJlcG9ydEZpbGVuYW1lVmFsaWRhdGlvblxuICAgICAgfSlcbiAgICB9XG4gIH0sXG4gICAgKGNvbnRleHQsIHJlcXVlc3QsIHJlc3BvbnNlKSA9PiBjdHJsLmdldFJlcG9ydEJ5TmFtZShjb250ZXh0LCByZXF1ZXN0LCByZXNwb25zZSlcbiAgKTtcblxuICAvLyBEZWxldGUgc3BlY2lmaWMgcmVwb3J0XG4gIHJvdXRlci5kZWxldGUoe1xuICAgIHBhdGg6ICcvcmVwb3J0cy97bmFtZX0nLFxuICAgIHZhbGlkYXRlOiB7XG4gICAgICBwYXJhbXM6IHNjaGVtYS5vYmplY3Qoe1xuICAgICAgICBuYW1lOiBSZXBvcnRGaWxlbmFtZVZhbGlkYXRpb25cbiAgICAgIH0pXG4gICAgfVxuICB9LFxuICAgIChjb250ZXh0LCByZXF1ZXN0LCByZXNwb25zZSkgPT4gY3RybC5kZWxldGVSZXBvcnRCeU5hbWUoY29udGV4dCwgcmVxdWVzdCwgcmVzcG9uc2UpXG4gIClcblxuICAvLyBGZXRjaCB0aGUgcmVwb3J0cyBsaXN0XG4gIHJvdXRlci5nZXQoe1xuICAgIHBhdGg6ICcvcmVwb3J0cycsXG4gICAgdmFsaWRhdGU6IGZhbHNlXG4gIH0sXG4gICAgKGNvbnRleHQsIHJlcXVlc3QsIHJlc3BvbnNlKSA9PiBjdHJsLmdldFJlcG9ydHMoY29udGV4dCwgcmVxdWVzdCwgcmVzcG9uc2UpXG4gICk7XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQVdBLElBQUFBLFlBQUEsR0FBQUMsT0FBQTtBQUVBLElBQUFDLGFBQUEsR0FBQUQsT0FBQTtBQWJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBS08sU0FBU0Usb0JBQW9CQSxDQUFDQyxNQUFlLEVBQUU7RUFDcEQsTUFBTUMsSUFBSSxHQUFHLElBQUlDLCtCQUFrQixDQUFDLENBQUM7RUFFckMsTUFBTUMsaUJBQWlCLEdBQUdDLG9CQUFNLENBQUNDLE1BQU0sQ0FBQztJQUN0Q0MsU0FBUyxFQUFFLENBQUM7SUFDWkMsUUFBUSxFQUFHQyxPQUFlLElBQUssVUFBVSxDQUFDQyxJQUFJLENBQUNELE9BQU8sQ0FBQyxHQUFHRSxTQUFTLEdBQUc7RUFDeEUsQ0FBQyxDQUFDO0VBRUYsTUFBTUMsaUJBQWlCLEdBQUdQLG9CQUFNLENBQUNDLE1BQU0sQ0FBQztJQUN0Q0MsU0FBUyxFQUFFLENBQUM7SUFDWkMsUUFBUSxFQUFHQyxPQUFlLElBQUssZ0NBQWdDLENBQUNDLElBQUksQ0FBQ0QsT0FBTyxDQUFDLEdBQUdFLFNBQVMsR0FBRztFQUM5RixDQUFDLENBQUM7RUFFRixNQUFNRSx3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