"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.SchedulerJob = void 0;
var _predefinedJobs = require("./predefined-jobs");
var _index = require("./index");
var _errorHandler = require("./error-handler");
var _configuredJobs = require("./configured-jobs");
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(arg) { var key = _toPrimitive(arg, "string"); return typeof key === "symbol" ? key : String(key); }
function _toPrimitive(input, hint) { if (typeof input !== "object" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || "default"); if (typeof res !== "object") return res; throw new TypeError("@@toPrimitive must return a primitive value."); } return (hint === "string" ? String : Number)(input); }
class SchedulerJob {
  constructor(jobName, context) {
    _defineProperty(this, "jobName", void 0);
    _defineProperty(this, "saveDocument", void 0);
    _defineProperty(this, "context", void 0);
    _defineProperty(this, "logger", void 0);
    _defineProperty(this, "apiClient", void 0);
    this.jobName = jobName;
    this.context = context;
    this.logger = context.wazuh.logger;
    this.apiClient = context.wazuh.api.client.asInternalUser;
    this.saveDocument = new _index.SaveDocument(context);
  }
  async run() {
    try {
      const {
        index,
        status
      } = (await (0, _configuredJobs.configuredJobs)(this.context, {}))[this.jobName];
      if (!status) {
        return;
      }
      const hosts = await this.getApiObjects();
      const jobPromises = hosts.map(async host => {
        try {
          const {
            status
          } = (await (0, _configuredJobs.configuredJobs)(this.context, {
            host,
            jobName: this.jobName
          }))[this.jobName];
          if (!status) return;
          return await this.getResponses(host);
        } catch (error) {
          (0, _errorHandler.ErrorHandler)(error, this.logger);
        }
      });
      const data = (await Promise.all(jobPromises)).filter(promise => !!promise).flat();
      Array.isArray(data) && !!data.length && (await this.saveDocument.save(data, index));
    } catch (error) {
      (0, _errorHandler.ErrorHandler)(error, this.logger);
    }
  }
  async getApiObjects() {
    const {
      apis
    } = _predefinedJobs.jobs[this.jobName];
    const hostsResponse = await this.context.wazuh_core.manageHosts.getEntries({
      excludePassword: true
    });
    if (!hostsResponse.length) throw {
      error: 10001,
      message: 'No API host configured in configuration'
    };
    if (apis && apis.length) {
      return this.filterHosts(hostsResponse, apis);
    }
    return hostsResponse;
  }
  filterHosts(hosts, apis) {
    const filteredHosts = hosts.filter(host => apis.includes(host.id));
    if (filteredHosts.length <= 0) {
      throw {
        error: 10002,
        message: 'No host was found with the indicated ID'
      };
    }
    return filteredHosts;
  }
  async getResponses(host) {
    const {
      request,
      params
    } = _predefinedJobs.jobs[this.jobName];
    const data = [];
    if (typeof request === 'string') {
      const apiResponse = await this.apiClient.request('GET', request, params, {
        apiHostID: host.id
      });
      data.push({
        ...apiResponse.data,
        apiName: host.id
      });
    } else {
      await this.getResponsesForIRequest(host, data);
    }
    return data;
  }
  async getResponsesForIRequest(host, data) {
    const {
      request,
      params
    } = _predefinedJobs.jobs[this.jobName];
    const fieldName = this.getParamName(typeof request !== 'string' && request.request);
    const paramList = await this.getParamList(fieldName, host);
    for (const param of paramList) {
      const paramRequest = typeof request !== 'string' && request.request.replace(/\{.+\}/, param);
      if (!!paramRequest) {
        const apiResponse = await this.apiClient.request('GET', paramRequest, params, {
          apiHostID: host.id
        });
        data.push({
          ...apiResponse.data,
          apiName: host.id,
          [fieldName]: param
        });
      }
    }
  }
  getParamName(request) {
    const regexResult = /\{(?<fieldName>.+)\}/.exec(request);
    if (regexResult === null) throw {
      error: 10003,
      message: `The parameter is not found in the Request: ${request}`
    };
    // @ts-ignore
    const {
      fieldName
    } = regexResult.groups;
    if (fieldName === undefined || fieldName === '') throw {
      error: 10004,
      message: `Invalid field in the request: {request: ${request}, field: ${fieldName}}`
    };
    return fieldName;
  }
  async getParamList(fieldName, host) {
    const {
      request
    } = _predefinedJobs.jobs[this.jobName];
    // @ts-ignore
    const apiResponse = await this.apiClient.request('GET', request.params[fieldName].request, {}, {
      apiHostID: host.id
    });
    const {
      affected_items
    } = apiResponse.data.data;
    if (affected_items === undefined || affected_items.length === 0) throw {
      error: 10005,
      message: `Empty response when tried to get the parameters list: ${JSON.stringify(apiResponse.data)}`
    };
    const values = affected_items.map(this.mapParamList);
    return values;
  }
  mapParamList(item) {
    if (typeof item !== 'object') {
      return item;
    }
    const keys = Object.keys(item);
    if (keys.length > 1 || keys.length < 0) throw {
      error: 10006,
      message: `More than one key or none were obtained: ${keys}`
    };
    return item[keys[0]];
  }
}
exports.SchedulerJob = SchedulerJob;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcHJlZGVmaW5lZEpvYnMiLCJyZXF1aXJlIiwiX2luZGV4IiwiX2Vycm9ySGFuZGxlciIsIl9jb25maWd1cmVkSm9icyIsIl9kZWZpbmVQcm9wZXJ0eSIsIm9iaiIsImtleSIsInZhbHVlIiwiX3RvUHJvcGVydHlLZXkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImFyZyIsIl90b1ByaW1pdGl2ZSIsIlN0cmluZyIsImlucHV0IiwiaGludCIsInByaW0iLCJTeW1ib2wiLCJ0b1ByaW1pdGl2ZSIsInVuZGVmaW5lZCIsInJlcyIsImNhbGwiLCJUeXBlRXJyb3IiLCJOdW1iZXIiLCJTY2hlZHVsZXJKb2IiLCJjb25zdHJ1Y3RvciIsImpvYk5hbWUiLCJjb250ZXh0IiwibG9nZ2VyIiwid2F6dWgiLCJhcGlDbGllbnQiLCJhcGkiLCJjbGllbnQiLCJhc0ludGVybmFsVXNlciIsInNhdmVEb2N1bWVudCIsIlNhdmVEb2N1bWVudCIsInJ1biIsImluZGV4Iiwic3RhdHVzIiwiY29uZmlndXJlZEpvYnMiLCJob3N0cyIsImdldEFwaU9iamVjdHMiLCJqb2JQcm9taXNlcyIsIm1hcCIsImhvc3QiLCJnZXRSZXNwb25zZXMiLCJlcnJvciIsIkVycm9ySGFuZGxlciIsImRhdGEiLCJQcm9taXNlIiwiYWxsIiwiZmlsdGVyIiwicHJvbWlzZSIsImZsYXQiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJzYXZlIiwiYXBpcyIsImpvYnMiLCJob3N0c1Jlc3BvbnNlIiwid2F6dWhfY29yZSIsIm1hbmFnZUhvc3RzIiwiZ2V0RW50cmllcyIsImV4Y2x1ZGVQYXNzd29yZCIsIm1lc3NhZ2UiLCJmaWx0ZXJIb3N0cyIsImZpbHRlcmVkSG9zdHMiLCJpbmNsdWRlcyIsImlkIiwicmVxdWVzdCIsInBhcmFtcyIsImFwaVJlc3BvbnNlIiwiYXBpSG9zdElEIiwicHVzaCIsImFwaU5hbWUiLCJnZXRSZXNwb25zZXNGb3JJUmVxdWVzdCIsImZpZWxkTmFtZSIsImdldFBhcmFtTmFtZSIsInBhcmFtTGlzdCIsImdldFBhcmFtTGlzdCIsInBhcmFtIiwicGFyYW1SZXF1ZXN0IiwicmVwbGFjZSIsInJlZ2V4UmVzdWx0IiwiZXhlYyIsImdyb3VwcyIsImFmZmVjdGVkX2l0ZW1zIiwiSlNPTiIsInN0cmluZ2lmeSIsInZhbHVlcyIsIm1hcFBhcmFtTGlzdCIsIml0ZW0iLCJrZXlzIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInNjaGVkdWxlci1qb2IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgam9icyB9IGZyb20gJy4vcHJlZGVmaW5lZC1qb2JzJztcbmltcG9ydCB7IElBcGksIFNhdmVEb2N1bWVudCB9IGZyb20gJy4vaW5kZXgnO1xuaW1wb3J0IHsgRXJyb3JIYW5kbGVyIH0gZnJvbSAnLi9lcnJvci1oYW5kbGVyJztcbmltcG9ydCB7IGNvbmZpZ3VyZWRKb2JzIH0gZnJvbSAnLi9jb25maWd1cmVkLWpvYnMnO1xuXG5leHBvcnQgY2xhc3MgU2NoZWR1bGVySm9iIHtcbiAgam9iTmFtZTogc3RyaW5nO1xuICBzYXZlRG9jdW1lbnQ6IFNhdmVEb2N1bWVudDtcbiAgY29udGV4dDogYW55O1xuICBsb2dnZXI6IGFueTtcbiAgYXBpQ2xpZW50OiBhbnk7XG5cbiAgY29uc3RydWN0b3Ioam9iTmFtZTogc3RyaW5nLCBjb250ZXh0KSB7XG4gICAgdGhpcy5qb2JOYW1lID0gam9iTmFtZTtcbiAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgIHRoaXMubG9nZ2VyID0gY29udGV4dC53YXp1aC5sb2dnZXI7XG4gICAgdGhpcy5hcGlDbGllbnQgPSBjb250ZXh0LndhenVoLmFwaS5jbGllbnQuYXNJbnRlcm5hbFVzZXI7XG4gICAgdGhpcy5zYXZlRG9jdW1lbnQgPSBuZXcgU2F2ZURvY3VtZW50KGNvbnRleHQpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHJ1bigpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBpbmRleCwgc3RhdHVzIH0gPSAoYXdhaXQgY29uZmlndXJlZEpvYnModGhpcy5jb250ZXh0LCB7fSkpW1xuICAgICAgICB0aGlzLmpvYk5hbWVcbiAgICAgIF07XG4gICAgICBpZiAoIXN0YXR1cykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBob3N0cyA9IGF3YWl0IHRoaXMuZ2V0QXBpT2JqZWN0cygpO1xuICAgICAgY29uc3Qgam9iUHJvbWlzZXMgPSBob3N0cy5tYXAoYXN5bmMgaG9zdCA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgeyBzdGF0dXMgfSA9IChcbiAgICAgICAgICAgIGF3YWl0IGNvbmZpZ3VyZWRKb2JzKHRoaXMuY29udGV4dCwge1xuICAgICAgICAgICAgICBob3N0LFxuICAgICAgICAgICAgICBqb2JOYW1lOiB0aGlzLmpvYk5hbWUsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIClbdGhpcy5qb2JOYW1lXTtcbiAgICAgICAgICBpZiAoIXN0YXR1cykgcmV0dXJuO1xuICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmdldFJlc3BvbnNlcyhob3N0KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBFcnJvckhhbmRsZXIoZXJyb3IsIHRoaXMubG9nZ2VyKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBjb25zdCBkYXRhID0gKGF3YWl0IFByb21pc2UuYWxsKGpvYlByb21pc2VzKSlcbiAgICAgICAgLmZpbHRlcihwcm9taXNlID0+ICEhcHJvbWlzZSlcbiAgICAgICAgLmZsYXQoKTtcbiAgICAgIEFycmF5LmlzQXJyYXkoZGF0YSkgJiZcbiAgICAgICAgISFkYXRhLmxlbmd0aCAmJlxuICAgICAgICAoYXdhaXQgdGhpcy5zYXZlRG9jdW1lbnQuc2F2ZShkYXRhLCBpbmRleCkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBFcnJvckhhbmRsZXIoZXJyb3IsIHRoaXMubG9nZ2VyKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdldEFwaU9iamVjdHMoKSB7XG4gICAgY29uc3QgeyBhcGlzIH0gPSBqb2JzW3RoaXMuam9iTmFtZV07XG4gICAgY29uc3QgaG9zdHNSZXNwb25zZTogSUFwaVtdID1cbiAgICAgIGF3YWl0IHRoaXMuY29udGV4dC53YXp1aF9jb3JlLm1hbmFnZUhvc3RzLmdldEVudHJpZXMoe1xuICAgICAgICBleGNsdWRlUGFzc3dvcmQ6IHRydWUsXG4gICAgICB9KTtcbiAgICBpZiAoIWhvc3RzUmVzcG9uc2UubGVuZ3RoKVxuICAgICAgdGhyb3cge1xuICAgICAgICBlcnJvcjogMTAwMDEsXG4gICAgICAgIG1lc3NhZ2U6ICdObyBBUEkgaG9zdCBjb25maWd1cmVkIGluIGNvbmZpZ3VyYXRpb24nLFxuICAgICAgfTtcbiAgICBpZiAoYXBpcyAmJiBhcGlzLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIHRoaXMuZmlsdGVySG9zdHMoaG9zdHNSZXNwb25zZSwgYXBpcyk7XG4gICAgfVxuICAgIHJldHVybiBob3N0c1Jlc3BvbnNlO1xuICB9XG5cbiAgcHJpdmF0ZSBmaWx0ZXJIb3N0cyhob3N0czogSUFwaVtdLCBhcGlzOiBzdHJpbmdbXSkge1xuICAgIGNvbnN0IGZpbHRlcmVkSG9zdHMgPSBob3N0cy5maWx0ZXIoaG9zdCA9PiBhcGlzLmluY2x1ZGVzKGhvc3QuaWQpKTtcbiAgICBpZiAoZmlsdGVyZWRIb3N0cy5sZW5ndGggPD0gMCkge1xuICAgICAgdGhyb3cge1xuICAgICAgICBlcnJvcjogMTAwMDIsXG4gICAgICAgIG1lc3NhZ2U6ICdObyBob3N0IHdhcyBmb3VuZCB3aXRoIHRoZSBpbmRpY2F0ZWQgSUQnLFxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIGZpbHRlcmVkSG9zdHM7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdldFJlc3BvbnNlcyhob3N0KTogUHJvbWlzZTxvYmplY3RbXT4ge1xuICAgIGNvbnN0IHsgcmVxdWVzdCwgcGFyYW1zIH0gPSBqb2JzW3RoaXMuam9iTmFtZV07XG4gICAgY29uc3QgZGF0YTogb2JqZWN0W10gPSBbXTtcblxuICAgIGlmICh0eXBlb2YgcmVxdWVzdCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGNvbnN0IGFwaVJlc3BvbnNlID0gYXdhaXQgdGhpcy5hcGlDbGllbnQucmVxdWVzdCgnR0VUJywgcmVxdWVzdCwgcGFyYW1zLCB7XG4gICAgICAgIGFwaUhvc3RJRDogaG9zdC5pZCxcbiAgICAgIH0pO1xuICAgICAgZGF0YS5wdXNoKHsgLi4uYXBpUmVzcG9uc2UuZGF0YSwgYXBpTmFtZTogaG9zdC5pZCB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5nZXRSZXNwb25zZXNGb3JJUmVxdWVzdChob3N0LCBkYXRhKTtcbiAgICB9XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdldFJlc3BvbnNlc0ZvcklSZXF1ZXN0KGhvc3Q6IGFueSwgZGF0YTogb2JqZWN0W10pIHtcbiAgICBjb25zdCB7IHJlcXVlc3QsIHBhcmFtcyB9ID0gam9ic1t0aGlzLmpvYk5hbWVdO1xuICAgIGNvbnN0IGZpZWxkTmFtZSA9IHRoaXMuZ2V0UGFyYW1OYW1lKFxuICAgICAgdHlwZW9mIHJlcXVlc3QgIT09ICdzdHJpbmcnICYmIHJlcXVlc3QucmVxdWVzdCxcbiAgICApO1xuICAgIGNvbnN0IHBhcmFtTGlzdCA9IGF3YWl0IHRoaXMuZ2V0UGFyYW1MaXN0KGZpZWxkTmFtZSwgaG9zdCk7XG4gICAgZm9yIChjb25zdCBwYXJhbSBvZiBwYXJhbUxpc3QpIHtcbiAgICAgIGNvbnN0IHBhcmFtUmVxdWVzdCA9XG4gICAgICAgIHR5cGVvZiByZXF1ZXN0ICE9PSAnc3RyaW5nJyAmJiByZXF1ZXN0LnJlcXVlc3QucmVwbGFjZSgvXFx7LitcXH0vLCBwYXJhbSk7XG4gICAgICBpZiAoISFwYXJhbVJlcXVlc3QpIHtcbiAgICAgICAgY29uc3QgYXBpUmVzcG9uc2UgPSBhd2FpdCB0aGlzLmFwaUNsaWVudC5yZXF1ZXN0KFxuICAgICAgICAgICdHRVQnLFxuICAgICAgICAgIHBhcmFtUmVxdWVzdCxcbiAgICAgICAgICBwYXJhbXMsXG4gICAgICAgICAgeyBhcGlIb3N0SUQ6IGhvc3QuaWQgfSxcbiAgICAgICAgKTtcbiAgICAgICAgZGF0YS5wdXNoKHtcbiAgICAgICAgICAuLi5hcGlSZXNwb25zZS5kYXRhLFxuICAgICAgICAgIGFwaU5hbWU6IGhvc3QuaWQsXG4gICAgICAgICAgW2ZpZWxkTmFtZV06IHBhcmFtLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldFBhcmFtTmFtZShyZXF1ZXN0KTogc3RyaW5nIHtcbiAgICBjb25zdCByZWdleFJlc3VsdCA9IC9cXHsoPzxmaWVsZE5hbWU+LispXFx9Ly5leGVjKHJlcXVlc3QpO1xuICAgIGlmIChyZWdleFJlc3VsdCA9PT0gbnVsbClcbiAgICAgIHRocm93IHtcbiAgICAgICAgZXJyb3I6IDEwMDAzLFxuICAgICAgICBtZXNzYWdlOiBgVGhlIHBhcmFtZXRlciBpcyBub3QgZm91bmQgaW4gdGhlIFJlcXVlc3Q6ICR7cmVxdWVzdH1gLFxuICAgICAgfTtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY29uc3QgeyBmaWVsZE5hbWUgfSA9IHJlZ2V4UmVzdWx0Lmdyb3VwcztcbiAgICBpZiAoZmllbGROYW1lID09PSB1bmRlZmluZWQgfHwgZmllbGROYW1lID09PSAnJylcbiAgICAgIHRocm93IHtcbiAgICAgICAgZXJyb3I6IDEwMDA0LFxuICAgICAgICBtZXNzYWdlOiBgSW52YWxpZCBmaWVsZCBpbiB0aGUgcmVxdWVzdDoge3JlcXVlc3Q6ICR7cmVxdWVzdH0sIGZpZWxkOiAke2ZpZWxkTmFtZX19YCxcbiAgICAgIH07XG4gICAgcmV0dXJuIGZpZWxkTmFtZTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0UGFyYW1MaXN0KGZpZWxkTmFtZSwgaG9zdCkge1xuICAgIGNvbnN0IHsgcmVxdWVzdCB9ID0gam9ic1t0aGlzLmpvYk5hbWVdO1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCBhcGlSZXNwb25zZSA9IGF3YWl0IHRoaXMuYXBpQ2xpZW50LnJlcXVlc3QoXG4gICAgICAnR0VUJyxcbiAgICAgIHJlcXVlc3QucGFyYW1zW2ZpZWxkTmFtZV0ucmVxdWVzdCxcbiAgICAgIHt9LFxuICAgICAgeyBhcGlIb3N0SUQ6IGhvc3QuaWQgfSxcbiAgICApO1xuICAgIGNvbnN0IHsgYWZmZWN0ZWRfaXRlbXMgfSA9IGFwaVJlc3BvbnNlLmRhdGEuZGF0YTtcbiAgICBpZiAoYWZmZWN0ZWRfaXRlbXMgPT09IHVuZGVmaW5lZCB8fCBhZmZlY3RlZF9pdGVtcy5sZW5ndGggPT09IDApXG4gICAgICB0aHJvdyB7XG4gICAgICAgIGVycm9yOiAxMDAwNSxcbiAgICAgICAgbWVzc2FnZTogYEVtcHR5IHJlc3BvbnNlIHdoZW4gdHJpZWQgdG8gZ2V0IHRoZSBwYXJhbWV0ZXJzIGxpc3Q6ICR7SlNPTi5zdHJpbmdpZnkoXG4gICAgICAgICAgYXBpUmVzcG9uc2UuZGF0YSxcbiAgICAgICAgKX1gLFxuICAgICAgfTtcbiAgICBjb25zdCB2YWx1ZXMgPSBhZmZlY3RlZF9pdGVtcy5tYXAodGhpcy5tYXBQYXJhbUxpc3QpO1xuICAgIHJldHVybiB2YWx1ZXM7XG4gIH1cblxuICBwcml2YXRlIG1hcFBhcmFtTGlzdChpdGVtKSB7XG4gICAgaWYgKHR5cGVvZiBpdGVtICE9PSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuIGl0ZW07XG4gICAgfVxuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhpdGVtKTtcbiAgICBpZiAoa2V5cy5sZW5ndGggPiAxIHx8IGtleXMubGVuZ3RoIDwgMClcbiAgICAgIHRocm93IHtcbiAgICAgICAgZXJyb3I6IDEwMDA2LFxuICAgICAgICBtZXNzYWdlOiBgTW9yZSB0aGFuIG9uZSBrZXkgb3Igbm9uZSB3ZXJlIG9idGFpbmVkOiAke2tleXN9YCxcbiAgICAgIH07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