"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.jobInitializeRun = jobInitializeRun;
var _package = _interopRequireDefault(require("../../../package.json"));
var _kibanaTemplate = require("../../integration-files/kibana-template");
var _os = require("os");
var _constants = require("../../../common/constants");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
/*
 * Wazuh app - Module for app initialization
 * Copyright (C) 2015-2022 Wazuh, Inc.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * Find more information about this on the LICENSE file.
 */

function jobInitializeRun(context) {
  const PLUGIN_PLATFORM_INDEX = context.server.config.opensearchDashboards.index;
  context.wazuh.logger.info(`${_constants.PLUGIN_PLATFORM_NAME} index: ${PLUGIN_PLATFORM_INDEX}`);
  context.wazuh.logger.info(`App revision: ${_package.default.revision}`);
  try {
    // RAM in MB
    context.wazuh.logger.debug('Getting the total RAM memory');
    const ram = Math.ceil((0, _os.totalmem)() / 1024 / 1024);
    context.wazuh.logger.info(`Total RAM: ${ram}MB`);
  } catch (error) {
    context.wazuh.logger.error(`Could not check total RAM due to: ${error.message}`);
  }
  const createKibanaTemplate = () => {
    context.wazuh.logger.debug(`Creating template for ${PLUGIN_PLATFORM_INDEX}`);
    try {
      _kibanaTemplate.pluginPlatformTemplate.template = PLUGIN_PLATFORM_INDEX + '*';
    } catch (error) {
      context.wazuh.logger.error('Exception: ' + error.message);
    }
    return context.core.opensearch.client.asInternalUser.indices.putTemplate({
      name: _constants.WAZUH_PLUGIN_PLATFORM_TEMPLATE_NAME,
      order: 0,
      create: true,
      body: _kibanaTemplate.pluginPlatformTemplate
    });
  };
  const createEmptyKibanaIndex = async () => {
    try {
      context.wazuh.logger.debug(`Creating ${PLUGIN_PLATFORM_INDEX} index.`);
      await context.core.opensearch.client.asInternalUser.indices.create({
        index: PLUGIN_PLATFORM_INDEX
      });
      context.wazuh.logger.info(`${PLUGIN_PLATFORM_INDEX} index created`);
    } catch (error) {
      throw new Error(`Error creating ${PLUGIN_PLATFORM_INDEX} index: ${error.message}`);
    }
  };
  const fixKibanaTemplate = async () => {
    try {
      context.wazuh.logger.debug(`Fixing ${PLUGIN_PLATFORM_INDEX} template`);
      await createKibanaTemplate();
      context.wazuh.logger.info(`${PLUGIN_PLATFORM_INDEX} template created`);
      await createEmptyKibanaIndex();
    } catch (error) {
      throw new Error(`Error creating template for ${PLUGIN_PLATFORM_INDEX}: ${error.message}`);
    }
  };
  const getTemplateByName = async () => {
    try {
      context.wazuh.logger.debug(`Getting ${_constants.WAZUH_PLUGIN_PLATFORM_TEMPLATE_NAME} template`);
      await context.core.opensearch.client.asInternalUser.indices.getTemplate({
        name: _constants.WAZUH_PLUGIN_PLATFORM_TEMPLATE_NAME
      });
      context.wazuh.logger.debug(`No need to create the ${PLUGIN_PLATFORM_INDEX} template, already exists.`);
      await createEmptyKibanaIndex();
    } catch (error) {
      context.wazuh.logger.warn(error.message || error);
      return fixKibanaTemplate();
    }
  };

  // Does Kibana index exist?
  const checkKibanaStatus = async () => {
    try {
      context.wazuh.logger.debug(`Checking the existence of ${PLUGIN_PLATFORM_INDEX} index`);
      const response = await context.core.opensearch.client.asInternalUser.indices.exists({
        index: PLUGIN_PLATFORM_INDEX
      });
      if (response.body) {
        context.wazuh.logger.debug(`${PLUGIN_PLATFORM_INDEX} index exist`);
      } else {
        context.wazuh.logger.debug(`${PLUGIN_PLATFORM_INDEX} index does not exist`);
        // No Kibana index created...
        context.wazuh.logger.info(`${PLUGIN_PLATFORM_INDEX} index not found`);
        await getTemplateByName();
      }
    } catch (error) {
      context.wazuh.logger.error(error.message || error);
    }
  };

  // Wait until Elasticsearch js is ready
  const checkStatus = async () => {
    try {
      // TODO: wait until opensearch is ready?
      // await server.plugins.opensearch.waitUntilReady();
      return await checkKibanaStatus();
    } catch (error) {
      context.wazuh.logger.debug('Waiting for opensearch plugin to be ready...');
      setTimeout(() => checkStatus(), 3000);
    }
  };

  // Check Kibana index and if it is prepared, start the initialization of Wazuh App.
  return checkStatus();
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcGFja2FnZSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2tpYmFuYVRlbXBsYXRlIiwiX29zIiwiX2NvbnN0YW50cyIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0Iiwiam9iSW5pdGlhbGl6ZVJ1biIsImNvbnRleHQiLCJQTFVHSU5fUExBVEZPUk1fSU5ERVgiLCJzZXJ2ZXIiLCJjb25maWciLCJvcGVuc2VhcmNoRGFzaGJvYXJkcyIsImluZGV4Iiwid2F6dWgiLCJsb2dnZXIiLCJpbmZvIiwiUExVR0lOX1BMQVRGT1JNX05BTUUiLCJwYWNrYWdlSlNPTiIsInJldmlzaW9uIiwiZGVidWciLCJyYW0iLCJNYXRoIiwiY2VpbCIsInRvdGFsbWVtIiwiZXJyb3IiLCJtZXNzYWdlIiwiY3JlYXRlS2liYW5hVGVtcGxhdGUiLCJwbHVnaW5QbGF0Zm9ybVRlbXBsYXRlIiwidGVtcGxhdGUiLCJjb3JlIiwib3BlbnNlYXJjaCIsImNsaWVudCIsImFzSW50ZXJuYWxVc2VyIiwiaW5kaWNlcyIsInB1dFRlbXBsYXRlIiwibmFtZSIsIldBWlVIX1BMVUdJTl9QTEFURk9STV9URU1QTEFURV9OQU1FIiwib3JkZXIiLCJjcmVhdGUiLCJib2R5IiwiY3JlYXRlRW1wdHlLaWJhbmFJbmRleCIsIkVycm9yIiwiZml4S2liYW5hVGVtcGxhdGUiLCJnZXRUZW1wbGF0ZUJ5TmFtZSIsImdldFRlbXBsYXRlIiwid2FybiIsImNoZWNrS2liYW5hU3RhdHVzIiwicmVzcG9uc2UiLCJleGlzdHMiLCJjaGVja1N0YXR1cyIsInNldFRpbWVvdXQiXSwic291cmNlcyI6WyJpbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogV2F6dWggYXBwIC0gTW9kdWxlIGZvciBhcHAgaW5pdGlhbGl6YXRpb25cbiAqIENvcHlyaWdodCAoQykgMjAxNS0yMDIyIFdhenVoLCBJbmMuXG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnlcbiAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5XG4gKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvclxuICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBGaW5kIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhpcyBvbiB0aGUgTElDRU5TRSBmaWxlLlxuICovXG5pbXBvcnQgcGFja2FnZUpTT04gZnJvbSAnLi4vLi4vLi4vcGFja2FnZS5qc29uJztcbmltcG9ydCB7IHBsdWdpblBsYXRmb3JtVGVtcGxhdGUgfSBmcm9tICcuLi8uLi9pbnRlZ3JhdGlvbi1maWxlcy9raWJhbmEtdGVtcGxhdGUnO1xuaW1wb3J0IHsgdG90YWxtZW0gfSBmcm9tICdvcyc7XG5pbXBvcnQge1xuICBXQVpVSF9QTFVHSU5fUExBVEZPUk1fVEVNUExBVEVfTkFNRSxcbiAgUExVR0lOX1BMQVRGT1JNX05BTUUsXG59IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9jb25zdGFudHMnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcblxuZXhwb3J0IGZ1bmN0aW9uIGpvYkluaXRpYWxpemVSdW4oY29udGV4dCkge1xuICBjb25zdCBQTFVHSU5fUExBVEZPUk1fSU5ERVggPVxuICAgIGNvbnRleHQuc2VydmVyLmNvbmZpZy5vcGVuc2VhcmNoRGFzaGJvYXJkcy5pbmRleDtcbiAgY29udGV4dC53YXp1aC5sb2dnZXIuaW5mbyhcbiAgICBgJHtQTFVHSU5fUExBVEZPUk1fTkFNRX0gaW5kZXg6ICR7UExVR0lOX1BMQVRGT1JNX0lOREVYfWAsXG4gICk7XG4gIGNvbnRleHQud2F6dWgubG9nZ2VyLmluZm8oYEFwcCByZXZpc2lvbjogJHtwYWNrYWdlSlNPTi5yZXZpc2lvbn1gKTtcblxuICB0cnkge1xuICAgIC8vIFJBTSBpbiBNQlxuICAgIGNvbnRleHQud2F6dWgubG9nZ2VyLmRlYnVnKCdHZXR0aW5nIHRoZSB0b3RhbCBSQU0gbWVtb3J5Jyk7XG4gICAgY29uc3QgcmFtID0gTWF0aC5jZWlsKHRvdGFsbWVtKCkgLyAxMDI0IC8gMTAyNCk7XG4gICAgY29udGV4dC53YXp1aC5sb2dnZXIuaW5mbyhgVG90YWwgUkFNOiAke3JhbX1NQmApO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnRleHQud2F6dWgubG9nZ2VyLmVycm9yKFxuICAgICAgYENvdWxkIG5vdCBjaGVjayB0b3RhbCBSQU0gZHVlIHRvOiAke2Vycm9yLm1lc3NhZ2V9YCxcbiAgICApO1xuICB9XG5cbiAgY29uc3QgY3JlYXRlS2liYW5hVGVtcGxhdGUgPSAoKSA9PiB7XG4gICAgY29udGV4dC53YXp1aC5sb2dnZXIuZGVidWcoXG4gICAgICBgQ3JlYXRpbmcgdGVtcGxhdGUgZm9yICR7UExVR0lOX1BMQVRGT1JNX0lOREVYfWAsXG4gICAgKTtcblxuICAgIHRyeSB7XG4gICAgICBwbHVnaW5QbGF0Zm9ybVRlbXBsYXRlLnRlbXBsYXRlID0gUExVR0lOX1BMQVRGT1JNX0lOREVYICsgJyonO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb250ZXh0LndhenVoLmxvZ2dlci5lcnJvcignRXhjZXB0aW9uOiAnICsgZXJyb3IubWVzc2FnZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvbnRleHQuY29yZS5vcGVuc2VhcmNoLmNsaWVudC5hc0ludGVybmFsVXNlci5pbmRpY2VzLnB1dFRlbXBsYXRlKHtcbiAgICAgIG5hbWU6IFdBWlVIX1BMVUdJTl9QTEFURk9STV9URU1QTEFURV9OQU1FLFxuICAgICAgb3JkZXI6IDAsXG4gICAgICBjcmVhdGU6IHRydWUsXG4gICAgICBib2R5OiBwbHVnaW5QbGF0Zm9ybVRlbXBsYXRlLFxuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGNyZWF0ZUVtcHR5S2liYW5hSW5kZXggPSBhc3luYyAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnRleHQud2F6dWgubG9nZ2VyLmRlYnVnKGBDcmVhdGluZyAke1BMVUdJTl9QTEFURk9STV9JTkRFWH0gaW5kZXguYCk7XG4gICAgICBhd2FpdCBjb250ZXh0LmNvcmUub3BlbnNlYXJjaC5jbGllbnQuYXNJbnRlcm5hbFVzZXIuaW5kaWNlcy5jcmVhdGUoe1xuICAgICAgICBpbmRleDogUExVR0lOX1BMQVRGT1JNX0lOREVYLFxuICAgICAgfSk7XG4gICAgICBjb250ZXh0LndhenVoLmxvZ2dlci5pbmZvKGAke1BMVUdJTl9QTEFURk9STV9JTkRFWH0gaW5kZXggY3JlYXRlZGApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBFcnJvciBjcmVhdGluZyAke1BMVUdJTl9QTEFURk9STV9JTkRFWH0gaW5kZXg6ICR7ZXJyb3IubWVzc2FnZX1gLFxuICAgICAgKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgZml4S2liYW5hVGVtcGxhdGUgPSBhc3luYyAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnRleHQud2F6dWgubG9nZ2VyLmRlYnVnKGBGaXhpbmcgJHtQTFVHSU5fUExBVEZPUk1fSU5ERVh9IHRlbXBsYXRlYCk7XG4gICAgICBhd2FpdCBjcmVhdGVLaWJhbmFUZW1wbGF0ZSgpO1xuICAgICAgY29udGV4dC53YXp1aC5sb2dnZXIuaW5mbyhgJHtQTFVHSU5fUExBVEZPUk1fSU5ERVh9IHRlbXBsYXRlIGNyZWF0ZWRgKTtcbiAgICAgIGF3YWl0IGNyZWF0ZUVtcHR5S2liYW5hSW5kZXgoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgRXJyb3IgY3JlYXRpbmcgdGVtcGxhdGUgZm9yICR7UExVR0lOX1BMQVRGT1JNX0lOREVYfTogJHtlcnJvci5tZXNzYWdlfWAsXG4gICAgICApO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBnZXRUZW1wbGF0ZUJ5TmFtZSA9IGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29udGV4dC53YXp1aC5sb2dnZXIuZGVidWcoXG4gICAgICAgIGBHZXR0aW5nICR7V0FaVUhfUExVR0lOX1BMQVRGT1JNX1RFTVBMQVRFX05BTUV9IHRlbXBsYXRlYCxcbiAgICAgICk7XG4gICAgICBhd2FpdCBjb250ZXh0LmNvcmUub3BlbnNlYXJjaC5jbGllbnQuYXNJbnRlcm5hbFVzZXIuaW5kaWNlcy5nZXRUZW1wbGF0ZSh7XG4gICAgICAgIG5hbWU6IFdBWlVIX1BMVUdJTl9QTEFURk9STV9URU1QTEFURV9OQU1FLFxuICAgICAgfSk7XG4gICAgICBjb250ZXh0LndhenVoLmxvZ2dlci5kZWJ1ZyhcbiAgICAgICAgYE5vIG5lZWQgdG8gY3JlYXRlIHRoZSAke1BMVUdJTl9QTEFURk9STV9JTkRFWH0gdGVtcGxhdGUsIGFscmVhZHkgZXhpc3RzLmAsXG4gICAgICApO1xuICAgICAgYXdhaXQgY3JlYXRlRW1wdHlLaWJhbmFJbmRleCgpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb250ZXh0LndhenVoLmxvZ2dlci53YXJuKGVycm9yLm1lc3NhZ2UgfHwgZXJyb3IpO1xuICAgICAgcmV0dXJuIGZpeEtpYmFuYVRlbXBsYXRlKCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIERvZXMgS2liYW5hIGluZGV4IGV4aXN0P1xuICBjb25zdCBjaGVja0tpYmFuYVN0YXR1cyA9IGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29udGV4dC53YXp1aC5sb2dnZXIuZGVidWcoXG4gICAgICAgIGBDaGVja2luZyB0aGUgZXhpc3RlbmNlIG9mICR7UExVR0lOX1BMQVRGT1JNX0lOREVYfSBpbmRleGAsXG4gICAgICApO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPVxuICAgICAgICBhd2FpdCBjb250ZXh0LmNvcmUub3BlbnNlYXJjaC5jbGllbnQuYXNJbnRlcm5hbFVzZXIuaW5kaWNlcy5leGlzdHMoe1xuICAgICAgICAgIGluZGV4OiBQTFVHSU5fUExBVEZPUk1fSU5ERVgsXG4gICAgICAgIH0pO1xuICAgICAgaWYgKHJlc3BvbnNlLmJvZHkpIHtcbiAgICAgICAgY29udGV4dC53YXp1aC5sb2dnZXIuZGVidWcoYCR7UExVR0lOX1BMQVRGT1JNX0lOREVYfSBpbmRleCBleGlzdGApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29udGV4dC53YXp1aC5sb2dnZXIuZGVidWcoXG4gICAgICAgICAgYCR7UExVR0lOX1BMQVRGT1JNX0lOREVYfSBpbmRleCBkb2VzIG5vdCBleGlzdGAsXG4gICAgICAgICk7XG4gICAgICAgIC8vIE5vIEtpYmFuYSBpbmRleCBjcmVhdGVkLi4uXG4gICAgICAgIGNvbnRleHQud2F6dWgubG9nZ2VyLmluZm8oYCR7UExVR0lOX1BMQVRGT1JNX0lOREVYfSBpbmRleCBub3QgZm91bmRgKTtcbiAgICAgICAgYXdhaXQgZ2V0VGVtcGxhdGVCeU5hbWUoKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29udGV4dC53YXp1aC5sb2dnZXIuZXJyb3IoZXJyb3IubWVzc2FnZSB8fCBlcnJvcik7XG4gICAgfVxuICB9O1xuXG4gIC8vIFdhaXQgdW50aWwgRWxhc3RpY3NlYXJjaCBqcyBpcyByZWFkeVxuICBjb25zdCBjaGVja1N0YXR1cyA9IGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gVE9ETzogd2FpdCB1bnRpbCBvcGVuc2VhcmNoIGlzIHJlYWR5P1xuICAgICAgLy8gYXdhaXQgc2VydmVyLnBsdWdpbnMub3BlbnNlYXJjaC53YWl0VW50aWxSZWFkeSgpO1xuICAgICAgcmV0dXJuIGF3YWl0IGNoZWNrS2liYW5hU3RhdHVzKCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnRleHQud2F6dWgubG9nZ2VyLmRlYnVnKFxuICAgICAgICAnV2FpdGluZyBmb3Igb3BlbnNlYXJjaCBwbHVnaW4gdG8gYmUgcmVhZHkuLi4nLFxuICAgICAgKTtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gY2hlY2tTdGF0dXMoKSwgMzAwMCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIENoZWNrIEtpYmFuYSBpbmRleCBhbmQgaWYgaXQgaXMgcHJlcGFyZWQsIHN0YXJ0IHRoZSBpbml0aWFsaXphdGlvbiBvZiBXYXp1aCBBcHAuXG4gIHJldHVybiBjaGVja1N0YXR1cygpO1xufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFXQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxlQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxHQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxVQUFBLEdBQUFILE9BQUE7QUFHbUMsU0FBQUQsdUJBQUFLLEdBQUEsV0FBQUEsR0FBQSxJQUFBQSxHQUFBLENBQUFDLFVBQUEsR0FBQUQsR0FBQSxLQUFBRSxPQUFBLEVBQUFGLEdBQUE7QUFqQm5DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBVU8sU0FBU0csZ0JBQWdCQSxDQUFDQyxPQUFPLEVBQUU7RUFDeEMsTUFBTUMscUJBQXFCLEdBQ3pCRCxPQUFPLENBQUNFLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDQyxvQkFBb0IsQ0FBQ0MsS0FBSztFQUNsREwsT0FBTyxDQUFDTSxLQUFLLENBQUNDLE1BQU0sQ0FBQ0MsSUFBSSxDQUN0QixHQUFFQywrQkFBcUIsV0FBVVIscUJBQXNCLEVBQzFELENBQUM7RUFDREQsT0FBTyxDQUFDTSxLQUFLLENBQUNDLE1BQU0sQ0FBQ0MsSUFBSSxDQUFFLGlCQUFnQkUsZ0JBQVcsQ0FBQ0MsUUFBUyxFQUFDLENBQUM7RUFFbEUsSUFBSTtJQUNGO0lBQ0FYLE9BQU8sQ0FBQ00sS0FBSyxDQUFDQyxNQUFNLENBQUNLLEtBQUssQ0FBQyw4QkFBOEIsQ0FBQztJQUMxRCxNQUFNQyxHQUFHLEdBQUdDLElBQUksQ0FBQ0MsSUFBSSxDQUFDLElBQUFDLFlBQVEs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